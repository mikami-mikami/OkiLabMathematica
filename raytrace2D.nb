(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    213837,       4638]
NotebookOptionsPosition[    211006,       4582]
NotebookOutlinePosition[    211364,       4598]
CellTagsIndexPosition[    211321,       4595]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\:3053\:306e\:90e8\:5206\:306f\:4fee\:6b63\:3092nb\:306e\:4fdd\:5b58\
\:3059\:308b\:3068\:304d\:306b\:5b9f\:884c\:3057\:307e\:3059\:3002\:ff08\:30e1\
\:30a4\:30f3\:30c6\:30ca\:30fc\:5411\:304d)", "Text",
 CellChangeTimes->{{3.733990733037222*^9, 
  3.733990752515559*^9}},ExpressionUUID->"7b0f4cff-1845-40b9-81db-\
39aad5a16217"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"saveC", "[", "]"}]], "Input",
 CellChangeTimes->{{3.736036145907029*^9, 3.7360361476964183`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"6d8c9cd3-d8e2-440b-bc9a-e12599b47063"],

Cell[BoxData["\<\"Saved in \
C:\\\\Users\\\\yuya\\\\Desktop\\\\initAndPackages\\\\raytrace2D_180523-125550.\
nb.\"\>"], "Print",
 CellChangeTimes->{3.736036550835044*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[15]:=",ExpressionUUID->"8db1c604-b2a3-4d9f-8060-\
960cf225ebeb"]
}, Open  ]],

Cell["\<\
\:3053\:306e\:90e8\:5206\:306f\:3001\:30d1\:30c3\:30b1\:30fc\:30b8\:3092\:30a4\
\:30f3\:30b9\:30c8\:30fc\:30eb\:3059\:308b\:3068\:304d\:306b\:5b9f\:884c\:3057\
\:307e\:3059\:3002\:521d\:671f\:5316\:30bb\:30eb\:3092\:5b9f\:884c\:3059\:308b\
\:304b\:3069\:3046\:304b\:306e\:8cea\:554f\:306b\:306fYes\:3068\:7b54\:3048\
\:3066\:4e0b\:3055\:3044\:3002\:30a4\:30f3\:30b9\:30c8\:30fc\:30eb\:306e\:7d50\
\:679c\:3001Users/XXX/Appdata/Roaming/Mathematica/Applications/\:306b
*.mx\:306e\:30d5\:30a1\:30a4\:30eb\:304c\:4f5c\:3089\:308c\:3001<<\:3067\:8aad\
\:307f\:53d6\:308a\:53ef\:80fd\:306b\:306a\:308a\:307e\:3059\:3002
??*`\:3067Help\:304c\:3067\:307e\:3059\:3002
*\:306f\:4e0b\:306e\:3001{}\:306b\:5165\:3063\:3066\:3044\:308b\:6587\:5b57\
\:5217\:ff08\:30d1\:30c3\:30b1\:30fc\:30b8\:540d)\:304c\:5165\:308a\:307e\
\:3059\:3002\
\>", "Text",
 CellChangeTimes->{{3.733990759488371*^9, 3.733990928532877*^9}, {
  3.7339911759901123`*^9, 
  3.7339911798032155`*^9}},ExpressionUUID->"80ce0e59-2d6a-427f-aabd-\
ace7b51290ae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DumpSave", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
      "\"\<rayTrace2D.mx\>\""}], "}"}], "]"}], ",", "\"\<rayTrace2D`\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7339667242132993`*^9, 3.7339667471657743`*^9}, {
  3.7339668161035957`*^9, 3.733966843526306*^9}, {3.7339680575430117`*^9, 
  3.733968061358493*^9}, {3.733992616717553*^9, 3.7339926396284056`*^9}, {
  3.7339933523298254`*^9, 3.7339933765538425`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"66f5f648-2583-438d-8b80-d0f812b1b3a3"],

Cell[BoxData[
 RowBox[{"{", "\<\"rayTrace2D`\"\>", "}"}]], "Output",
 CellChangeTimes->{{3.7339667829908495`*^9, 3.7339668168816967`*^9}, 
   3.7339668892346287`*^9, 3.733966931308259*^9, 3.733967042710357*^9, 
   3.7339671083577485`*^9, 3.733967193431552*^9, 3.733967308925364*^9, 
   3.7339680804294624`*^9, 3.7339681546829824`*^9, 3.733968228085497*^9, 
   3.733968301422761*^9, 3.7339684699104853`*^9, 3.733992675435823*^9, {
   3.7339932134860725`*^9, 3.733993234515008*^9}, 3.733994254131085*^9, 
   3.7339943803892326`*^9, 3.7339955621707325`*^9, 3.736037454964229*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"8a2a3883-ef49-4228-9170-984e9b5cdce6"]
}, Open  ]],

Cell["\<\
\:30d1\:30c3\:30b1\:30fc\:30b8\:3092\:8aad\:307f\:8fbc\:3093\:3060\:5f8c\:3001\
??\:30d1\:30c3\:30b1\:30fc\:30b8\:540d`* \:3067\:3001\:30d8\:30eb\:30d7\:304c\
\:51fa\:307e\:3059\:3002\:3053\:306e\:6642\:3001 <<\:30d5\:30a1\:30a4\:30eb\
\:540d` \:3067\:3042\:308a\:3001??\:30d1\:30c3\:30b1\:30fc\:30b8\:540d`\:3067\
\:3001\:4e21\:8005\:306f\:63c3\:3063\:3066\:3044\:306a\:3044\:5834\:5408\:3082\
\:6709\:308b\:3053\:3068\:306b\:6ce8\:610f\:3057\:3066\:4e0b\:3055\:3044\:3002\
\>", "Text",
 CellChangeTimes->{{3.7339911641999426`*^9, 
  3.7339912879532127`*^9}},ExpressionUUID->"f09f2183-06e3-4014-8e39-\
0b90e1dab1a4"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<rayTrace2D`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7339927027294216`*^9, 3.733992713636507*^9}, {
  3.73399280616639*^9, 3.733992807572915*^9}, {3.733993360769896*^9, 
  3.733993360937514*^9}, {3.733994240791727*^9, 3.7339942409833*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"31ef5261-5d48-43ca-b767-70640ca539e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rayTrace", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7339956589496984`*^9, 3.733995661961549*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"83b485bb-e757-4774-ae0d-08573199093c"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1:eJxd1GlM03cYB/DSH9dfAZGoYx7IGScUHRG55XkGjnEIclronBMUKJM7EkCI
MiZXHMqhCCoKRvBAyHAdgXJMqNmo0MLAIWGioHKUu5RyU8ZiX+1JvnnyefNN
njePXlCUdzCdRqO5b+S//f+x4Z6sF+11ATaxyrfb5gmfHCD3abnD5I6WO1Hu
FLmz5M6Ru0juErkfy/0LJO1j08IPcEHngiqX1fwcPJKQMRHLg2g/5Vnux1Y4
oVcUx6niQ/z9J5l3ozpB1lQ/89aqE3L9uBWRvFeQWkWfKzndDXu5ec88Bb1w
IvHnTNLeA6qs7vZm034IOdNgErWvD4jDqcnBhgEo0zi6W9ulHxoPWg6PN76H
264qHV8yB8DQ9gX7yNhHSIostJibGISv7x3uvykehqXSZKOGCx8gxjmpjTs1
CrqO9O98jYfg2JY4R6PPxuHdi0O2mxuHYeCAT2Xhzklw4igH5cWMgn74UImP
yzS4/crQ1NEZA8sFo4zxmhkYzZOdba0ch/qzbTXVNWIwHYihO34/CdsHXSt2
tc/CJo1cpzeSKWjPatDe1CGB1lePRPp+M8D6StXtzsgcsJ48kwQwxBCxy56r
tSIFq2gtL12pGN7qhdxXX50H0URLl1A4C0aW7ONPtRZhJID/UO2WBPgJJ+M6
diwBxyPx+bHAOZC8sent2b4MvsuJa+etpTB3XLL+o/EKOBR0ZjPIPHhNF5dU
M1aBLop3aO+fh7RifeW0o2uQx2u1ieQsAETmPrJjyiDqalT6veRFYJ6b5SUw
12GvZuh8rd8S3K/f4f3Ugoa7Uzl1gbrL0MqsvHiqlobDSRXP1UaW4aBSHT/V
UgHTGJLxe00rQLhmCwnNChgtyPmhJWMVlNIMAs0c6HjQ6JK6IHANYpmplfUC
OtpG8EioqQw0kGWh6klw25HqI0Qqgwnrh/1/dBDk8aZvZwjWwcI2MJTJUsRT
e1rKBW40rPK+bvrkH0V04nBy3epomBdj3iMMVcJtW5LvvjRUwLpSl+JgsRJS
QVO+W7MUUGP0dUlTjDKyNbP2tEsVsONwd7poVRknaoTXPL6lY2PRN497Lqqg
v57IoKuJjtMaZmOHZSp4YMTkJd+Y4JUrGeqhmapoXPb5zqxrBJk6zAgWRWGB
fbXUNZfgZQtFq1ubKVTodf5LLZ9gtUc1vU+dwt5NCZk5BQTVLm0uDNCiMD26
Z/5mMcHmd7+3+O+icMA2v7u8gqBJ6RfaTFMKb3SpZb/4k6DMYLnFx2ujL/wB
O51PkGH3MDvfh8JwJbujzm0EA3x9/bv9KHS0OrfSJiTIuVw16c2icKaYH9b9
N8GwoSBt7zMUuoWlO73/QLCrvC3CM47CGrqO/oMhgutNCVY58RTq3fltLXhk
o/+1EelMpHBR+JEjGiOYoZJSePwihWXmjgZiMUE7tjnPI4NCTWGf7Jlkoz9l
MPtqFoXJobF956UECwqv+guvUOh9qzR3cZGguHV00j2HwqZD1hHcZYI6gzdq
s/Mo3C/odE5eJei25PCT4PrGvSFsQ3sZwcStM+7qNyn89LUUsXx/sbZ7EYX/
Aj9MKLE=
       "]]},
     Annotation[#, "Charting`Private`Tag$8329#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], Opacity[
      1.], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1:eJw1lH0w1Hkcx5dddn+sh93N0CVa0oMeTnGtm+jziWRP1+gYgxDCsVp7JUPp
AdeD59Ak0aLCuiud3J3uKHtkO1zlnM11lIeKlTOKbBfL6n6r2c/Mdz7zmvfD
fP/6cPd/4xOlS6FQdpNPsz8ODSVrSy12FxP4sP7yQoEOyfcMCryKCCw6wFPb
UmlYFXSE4BcS+OkTkcpTn4aVub4qtwICQ37oV+YxaVgxRTxzziSwMfjOmPVS
GpY3JJavPEpgQkOiHDbT8NIXe1bNBxA4Fj8hSYmkYbaA6nTDgkCX7dSww3/R
kHZtXsjLZWA9XXZvI08PvWXHBTqGDDQ7H+g5XqKH/j3pnoHZdBxKMh9YRtdH
5YCd+yCFjl1+qVZLhPq4v9tLtyJFH9flsQ6l9upjlFR38MK0HsblJI1M7KCj
XbFH6ZJYPexJy6Dafk/HX0JMrLvHaFjd3eL40IyB/Z8IpU37yH8vkxi5HmNg
T4s3d/QZFU+uCSVqBxiY5S+NKguhYns+mhd6ESgf+a3tlFwXnacedrrVEvg6
hD8h8dFF9s20S5GWBljWGeEw87sOytcbnk5PN0CDjQZ+T1x1sLESlsaPGyA/
ieeqbKKg4RFxc5e/IVo2vHcDRwp+617Jen/XEFM7TljkR3yAyNjHCQX2THzL
2qxQey3ABr/e2fUXmTjIm09M56nB0jlzTb6KiaJNj8/lbJmHhMRwQXS0Ea62
7H4+YT0HypphX/1HRniqr//OH8tUsLfaJUziYIyBiR8CWi1nwV5992Sj2BgD
qJ6bLBgzwN31audFHROcixDnv9J7D2nKrVyFyATb6s3Xmb1+Bx3hkct5fSZo
NPJdRshTJYhfXn6+2toU3416xnGfTgNDVuwq8jNFxjNm7vb7byF9RZzIIsMU
71YMOva3TIFqwN6htcEUX/PbSy+0TgL3wbyq+o0p5khvntkT+gaCHStLJrks
PH1e0S8KnoAvO0LdDwewsIt/oMZj4zh4P51sDsxmYZjEMJNjNwYe3sI/sYmF
r6RPxi1WjcLU5JwifJqFzQ1vZH/PDUOtcbhcYcfGoSDbmuz/XoDt3r72qmA2
7hm6RszeH4Is+jbvqPNsjAFx31boB9qmpOsZMjY2M+2lh116wSlDZqxQsfHX
Mu9zli8fQ2LQqGf1Bg7yU2qSf5J3QU2+kiUI5eDBGy2K+LoOKJo2G4ks5OCt
54F1YcYtUNjNzJW1cXBI0BLjt1AHu8r/Sa5q5yBGWnGCb9cBRVgZc7aDg1f2
HWvaL6oDoZ7LDv4DUvf9jH1w4Ba4Ox+Ye9BJ8lGfJLMTtTBZ2iGQ93Cw2cpm
ear6OngJzu588ZKDlFhN/1WgbPFxah3mYOpi31W4rWtlUzmi7bsCNuJ6ddQo
6V/sK4eZzuGfx/4l/Yt9JSBxcredmtL2FUCQjgmr+y2pL+bzwbSzb+HHaVJP
1uTz4Hh0fF/CO5KtNfks8Cm5WjAzo82nASM6LqV3VutPAanj53GNKpJXaPzJ
sPZRF//4vNZ/CAaLxVtC1Fo9Fi58HbNy2wLJQo0eDl6OTmzrDyTHaPgr+Hi/
lqD2kv0Pso4UTQ==
       "]]},
     Annotation[#, "Charting`Private`Tag$8329#2"]& ], 
    TagBox[
     {RGBColor[0.560181, 0.691569, 0.194885], AbsoluteThickness[1.6], Opacity[
      1.], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1: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
At6tNVI=
       "]]},
     Annotation[#, "Charting`Private`Tag$8329#3"]& ], 
    TagBox[
     {RGBColor[0.922526, 0.385626, 0.209179], AbsoluteThickness[1.6], Opacity[
      1.], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1: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
       "]]},
     Annotation[#, "Charting`Private`Tag$8329#4"]& ], 
    TagBox[
     {RGBColor[0.528488, 0.470624, 0.701351], AbsoluteThickness[1.6], Opacity[
      1.], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1: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
6Lumz2bmB7Co94U11/egg/67WNT//w/5HxPb/R4=
       "]]},
     Annotation[#, "Charting`Private`Tag$8329#5"]& ], 
    TagBox[
     {RGBColor[0.772079, 0.431554, 0.102387], AbsoluteThickness[1.6], Opacity[
      1.], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1: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
A82x6VI=
       "]]},
     Annotation[#, "Charting`Private`Tag$8329#6"]& ]}, {
    {LCHColor[1., 0.5626244058072859, 0.4], Thickness[0.005], 
     LineBox[{{0.9175898893409876, -2.618615316006415}, {
      3.667172778201819, -5.523747660200691}}]}, 
    {LCHColor[1., 0.2542965832360922, 0.4], Thickness[0.005], 
     LineBox[{{0.9175898893409876, -2.618615316006415}, {
      1.7676511215109083`, -1.5429822737076282`}}]}, 
    {LCHColor[1., 0.5923454705302, 0.4], Thickness[0.005], 
     LineBox[{{0.6263808106167998, -1.9579262928351358`}, {
      0.9175898893409876, -2.618615316006415}}]}, 
    {LCHColor[1., 0.8313153238089916, 0.4], Thickness[0.005], 
     LineBox[{{
      0.6263808106167998, -1.9579262928351358`}, {-3.3296279681819927`, \
-1.36632292733854}}]}, 
    {LCHColor[1., 0.9587967870004829, 0.4], Thickness[0.005], 
     LineBox[{{0.2862099777174235, -0.24139644231140234`}, {
      0.6263808106167998, -1.9579262928351358`}}]}, 
    {LCHColor[1., 0.329513910470171, 0.4], Thickness[0.005], 
     LineBox[{{3.9756289636261055`, 1.311135136267718}, {7.81352051230438, 
      2.438338960154009}}]}, 
    {LCHColor[1., 0.12146395894643013`, 0.4], Thickness[0.005], 
     LineBox[{{2.5960339524642055`, -0.5315538159375395}, {
      1.6038436176445954`, -1.50647009815531}}]}, 
    {LCHColor[1., 0.04889129005771465, 0.4], Thickness[0.005], 
     LineBox[{{2.5960339524642055`, -0.5315538159375395}, {2.420983170448485, 
      3.098717150695809}}]}, 
    {LCHColor[1., 0.12631208574010794`, 0.4], Thickness[0.005], 
     LineBox[{{3.9756289636261055`, 1.311135136267718}, {
      2.5960339524642055`, -0.5315538159375395}}]}, 
    {LCHColor[1., 0.34119280690321846`, 0.4], Thickness[0.005], 
     LineBox[{{0.2862099777174235, -0.24139644231140234`}, {
      3.9756289636261055`, 1.311135136267718}}]}, 
    {LCHColor[1., 0.9871368683948336, 0.4], Thickness[0.005], 
     LineBox[{{0.3396982217264971, 0.4347938963696991}, {
      0.2862099777174235, -0.24139644231140234`}}]}, 
    {LCHColor[1., 0.9871368683948336, 0.4], Thickness[0.005], 
     LineBox[{{3.763964296110463, 1.5820535562852955`}, {0.3396982217264971, 
      0.4347938963696991}}]}, 
    {LCHColor[1., 0.25190353951457556`, 0.4], Thickness[0.005], 
     LineBox[{{3.763964296110463, 1.5820535562852955`}, {5.390910868413664, 
      5.2362353868557}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.763964296110463, 1.5820535562852955`}}]}, 
    {LCHColor[1., 0.5698445803925113, 0.4], Thickness[0.005], 
     LineBox[{{1.0279291642684742`, -2.631440325912966}, {
      3.553760282407039, -5.733081369399928}}]}, 
    {LCHColor[1., 0.23642643865625781`, 0.4], Thickness[0.005], 
     LineBox[{{1.0279291642684742`, -2.631440325912966}, {
      1.7676376943853576`, -1.5429779612735461`}}]}, 
    {LCHColor[1., 0.5943237899457117, 0.4], Thickness[0.005], 
     LineBox[{{0.7163610560138703, -1.868453996719018}, {
      1.0279291642684742`, -2.631440325912966}}]}, 
    {LCHColor[1., 0.834091756359462, 0.4], Thickness[0.005], 
     LineBox[{{
      0.7163610560138703, -1.868453996719018}, {-3.161445136058981, \
-0.8873224373848727}}]}, 
    {LCHColor[1., 0.9619989830053842, 0.4], Thickness[0.005], 
     LineBox[{{0.4274729998637664, -0.3363209513502381}, {
      0.7163610560138703, -1.868453996719018}}]}, 
    {LCHColor[1., 0.3145661694864223, 0.4], Thickness[0.005], 
     LineBox[{{3.788916911867186, 1.550115664546148}, {7.393081079432223, 
      3.2850510100965895`}}]}, 
    {LCHColor[1., 0.10371943380880191`, 0.4], Thickness[0.005], 
     LineBox[{{
      1.655955092630959, -0.713244032328266}, {-2.1033676203515963`, \
-2.079806412775454}}]}, 
    {LCHColor[1., 0.06752491862508857, 0.4], Thickness[0.005], 
     LineBox[{{1.655955092630959, -0.713244032328266}, {0.5300993513355611, 
      0.6784962289729304}}]}, 
    {LCHColor[1., 0.11667007702843214`, 0.4], Thickness[0.005], 
     LineBox[{{3.788916911867186, 1.550115664546148}, {
      1.655955092630959, -0.713244032328266}}]}, 
    {LCHColor[1., 0.3248536841933481, 0.4], Thickness[0.005], 
     LineBox[{{0.4274729998637664, -0.3363209513502381}, {3.788916911867186, 
      1.550115664546148}}]}, 
    {LCHColor[1., 0.9870079335227167, 0.4], Thickness[0.005], 
     LineBox[{{0.4806658180277913, 0.6152241916659127}, {
      0.4274729998637664, -0.3363209513502381}}]}, 
    {LCHColor[1., 0.9870079335227167, 0.4], Thickness[0.005], 
     LineBox[{{3.7328249084735394`, 1.6219101549227921`}, {0.4806658180277913,
       0.6152241916659127}}]}, 
    {LCHColor[1., 0.2529006751354479, 0.4], Thickness[0.005], 
     LineBox[{{3.7328249084735394`, 1.6219101549227921`}, {5.231251282137189, 
      5.330645573189942}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.7328249084735394`, 1.6219101549227921`}}]}, 
    {LCHColor[1., 0.5748979217282384, 0.4], Thickness[0.005], 
     LineBox[{{1.1429869449489718`, -2.642177320127888}, {
      3.428278016390502, -5.925079194809741}}]}, 
    {LCHColor[1., 0.22238550741499055`, 0.4], Thickness[0.005], 
     LineBox[{{1.1429869449489718`, -2.642177320127888}, {
      1.7710255775707342`, -1.54407291821853}}]}, 
    {LCHColor[1., 0.5957296767215868, 0.4], Thickness[0.005], 
     LineBox[{{0.8206983370325709, -1.776870449586189}, {
      1.1429869449489718`, -2.642177320127888}}]}, 
    {LCHColor[1., 0.8360648198476984, 0.4], Thickness[0.005], 
     LineBox[{{
      0.8206983370325709, -1.776870449586189}, {-2.8886706814287058`, \
-0.28001324701821195`}}]}, 
    {LCHColor[1., 0.9642746140191388, 0.4], Thickness[0.005], 
     LineBox[{{0.5730443736632208, -0.4204421205593294}, {
      0.8206983370325709, -1.776870449586189}}]}, 
    {LCHColor[1., 0.30253866220415176`, 0.4], Thickness[0.005], 
     LineBox[{{3.6186171581290862`, 1.7680894093077713`}, {6.904731736448944, 
      4.048758385321983}}]}, 
    {LCHColor[1., 0.10477112885530776`, 0.4], Thickness[0.005], 
     LineBox[{{
      0.8765101105786299, -0.5573196439419352}, {-2.716053815250674, \
-2.316150061813408}}]}, 
    {LCHColor[1., 0.04830780639261827, 0.4], Thickness[0.005], 
     LineBox[{{0.8765101105786299, -0.5573196439419352}, {0.6599472423428521, 
      0.8446939505256315}}]}, 
    {LCHColor[1., 0.11057738248981934`, 0.4], Thickness[0.005], 
     LineBox[{{3.6186171581290862`, 1.7680894093077713`}, {
      0.8765101105786299, -0.5573196439419352}}]}, 
    {LCHColor[1., 0.3120851490764865, 0.4], Thickness[0.005], 
     LineBox[{{0.5730443736632208, -0.4204421205593294}, {3.6186171581290862`,
       1.7680894093077713`}}]}, 
    {LCHColor[1., 0.9868611297012041, 0.4], Thickness[0.005], 
     LineBox[{{0.6128319832392363, 0.7843891688873497}, {
      0.5730443736632208, -0.4204421205593294}}]}, 
    {LCHColor[1., 0.9868611297012041, 0.4], Thickness[0.005], 
     LineBox[{{3.700404049937645, 1.6634069615143259`}, {0.6128319832392363, 
      0.7843891688873497}}]}, 
    {LCHColor[1., 0.2540286346187498, 0.4], Thickness[0.005], 
     LineBox[{{3.700404049937645, 1.6634069615143259`}, {5.0684846232403205`, 
      5.42217744465796}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.700404049937645, 1.6634069615143259`}}]}, 
    {LCHColor[1., 0.5784467253356539, 0.4], Thickness[0.005], 
     LineBox[{{1.2557396699701806`, -2.6501043923657903`}, {
      3.2807243333516523`, -6.099660467148432}}]}, 
    {LCHColor[1., 0.21161651210652008`, 0.4], Thickness[0.005], 
     LineBox[{{1.2557396699701806`, -2.6501043923657903`}, {
      1.7741962326644676`, -1.5451101444044322`}}]}, 
    {LCHColor[1., 0.5967405737538007, 0.4], Thickness[0.005], 
     LineBox[{{0.9367077954434033, -1.6903788646285385`}, {
      1.2557396699701806`, -2.6501043923657903`}}]}, 
    {LCHColor[1., 0.8374835429332658, 0.4], Thickness[0.005], 
     LineBox[{{0.9367077954434033, -1.6903788646285385`}, {-2.453827170658624,
       0.4319483117605185}}]}, 
    {LCHColor[1., 0.9659108970240675, 0.4], Thickness[0.005], 
     LineBox[{{0.7223190657253417, -0.4938578156992336}, {
      0.9367077954434033, -1.6903788646285385`}}]}, 
    {LCHColor[1., 0.29271554143651074`, 0.4], Thickness[0.005], 
     LineBox[{{3.4585714266084464`, 1.972938604135834}, {6.351091489407709, 
      4.735786353524814}}]}, 
    {LCHColor[1., 0.10324401689865365`, 0.4], Thickness[0.005], 
     LineBox[{{
      0.23159034942852408`, -0.2007871605908964}, {-3.367656633403005, \
-1.9459006688126794`}}]}, 
    {LCHColor[1., 0.041072538660321956`, 0.4], Thickness[0.005], 
     LineBox[{{0.23159034942852408`, -0.2007871605908964}, {0.531119574389413,
       0.6798020549336787}}]}, 
    {LCHColor[1., 0.10724906251503584`, 0.4], Thickness[0.005], 
     LineBox[{{3.4585714266084464`, 1.972938604135834}, {
      0.23159034942852408`, -0.2007871605908964}}]}, 
    {LCHColor[1., 0.30200741811683507`, 0.4], Thickness[0.005], 
     LineBox[{{0.7223190657253417, -0.4938578156992336}, {3.4585714266084464`,
       1.972938604135834}}]}, 
    {LCHColor[1., 0.9866945138988178, 0.4], Thickness[0.005], 
     LineBox[{{0.7373649157525398, 0.9437840537902179}, {
      0.7223190657253417, -0.4938578156992336}}]}, 
    {LCHColor[1., 0.9866945138988178, 0.4], Thickness[0.005], 
     LineBox[{{3.6665367222867955`, 1.7067551641457717`}, {0.7373649157525398,
       0.9437840537902179}}]}, 
    {LCHColor[1., 0.2552994821150578, 0.4], Thickness[0.005], 
     LineBox[{{3.6665367222867955`, 1.7067551641457717`}, {4.902604699786586, 
      5.5109812293263865`}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.6665367222867955`, 1.7067551641457717`}}]}, 
    {LCHColor[1., 0.580945357646143, 0.4], Thickness[0.005], 
     LineBox[{{1.3619695307375048`, -2.6552340206105813`}, {
      3.102151397169499, -6.2568679653280705`}}]}, 
    {LCHColor[1., 0.20350103857651564`, 0.4], Thickness[0.005], 
     LineBox[{{1.3619695307375048`, -2.6552340206105813`}, {
      1.7739481872478051`, -1.545028565577815}}]}, 
    {LCHColor[1., 0.5974674374014641, 0.4], Thickness[0.005], 
     LineBox[{{1.0626610580002305`, -1.6147592101136867`}, {
      1.3619695307375048`, -2.6552340206105813`}}]}, 
    {LCHColor[1., 0.8385036450842647, 0.4], Thickness[0.005], 
     LineBox[{{
      1.0626610580002305`, -1.6147592101136867`}, {-1.781048727731972, 
      1.1983022279873263`}}]}, 
    {LCHColor[1., 0.9670874309297683, 0.4], Thickness[0.005], 
     LineBox[{{0.8747336885476771, -0.5566561128299476}, {
      1.0626610580002305`, -1.6147592101136867`}}]}, 
    {LCHColor[1., 0.28452017737578167`, 0.4], Thickness[0.005], 
     LineBox[{{3.303623966910325, 2.1712623086060194`}, {5.732680024736602, 
      5.34926272835701}}]}, 
    {LCHColor[1., 0.10633595581406856`, 0.4], Thickness[0.005], 
     LineBox[{{0.5801260186863317, 0.7425274432350559}, {
      0.3326387840488416, -0.27414771781812397`}}]}, 
    {LCHColor[1., 0.10633595581406856`, 0.4], Thickness[0.005], 
     LineBox[{{3.303623966910325, 2.1712623086060194`}, {0.5801260186863317, 
      0.7425274432350559}}]}, 
    {LCHColor[1., 0.2940002722293328, 0.4], Thickness[0.005], 
     LineBox[{{0.8747336885476771, -0.5566561128299476}, {3.303623966910325, 
      2.1712623086060194`}}]}, 
    {LCHColor[1., 0.9865060197815687, 0.4], Thickness[0.005], 
     LineBox[{{0.8552951567291573, 1.0947278789107528`}, {
      0.8747336885476771, -0.5566561128299476}}]}, 
    {LCHColor[1., 0.9865060197815687, 0.4], Thickness[0.005], 
     LineBox[{{3.6310354621947267`, 1.7521947049329252`}, {0.8552951567291573,
       1.0947278789107528`}}]}, 
    {LCHColor[1., 0.25672547553358893`, 0.4], Thickness[0.005], 
     LineBox[{{3.6310354621947267`, 1.7521947049329252`}, {4.733584885462724, 
      5.5972414886862}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.6310354621947267`, 1.7521947049329252`}}]}, 
    {LCHColor[1., 0.5826906270716334, 0.4], Thickness[0.005], 
     LineBox[{{1.4597296847106835`, -2.6579558778458656`}, {
      2.885276246550559, -6.395310155945081}}]}, 
    {LCHColor[1., 0.19752485077255216`, 0.4], Thickness[0.005], 
     LineBox[{{1.4597296847106835`, -2.6579558778458656`}, {
      1.7676965883223468`, -1.5429968780396544`}}]}, 
    {LCHColor[1., 0.597982328549536, 0.4], Thickness[0.005], 
     LineBox[{{1.1975153993551002`, -1.5548981601763827`}, {
      1.4597296847106835`, -2.6579558778458656`}}]}, 
    {LCHColor[1., 0.8249357794324519, 0.4], Thickness[0.005], 
     LineBox[{{0.5346180784309666, -0.39949419125939745`}, {0.40033631777605, 
      0.5124071200004445}}]}, 
    {LCHColor[1., 0.2362085923601129, 0.4], Thickness[0.005], 
     LineBox[{{
      0.5346180784309666, -0.39949419125939745`}, {-3.46304443434582, \
-0.5362217815226167}}]}, 
    {LCHColor[1., 0.8392262586987532, 0.4], Thickness[0.005], 
     LineBox[{{1.1975153993551002`, -1.5548981601763827`}, {
      0.5346180784309666, -0.39949419125939745`}}]}, 
    {LCHColor[1., 0.9679208566973098, 0.4], Thickness[0.005], 
     LineBox[{{1.0297690116794556`, -0.6089165968737547}, {
      1.1975153993551002`, -1.5548981601763827`}}]}, 
    {LCHColor[1., 0.2774464522906909, 0.4], Thickness[0.005], 
     LineBox[{{3.1489836626291425`, 2.36919287207051}, {5.047397073295368, 
      5.8899920032625515`}}]}, 
    {LCHColor[1., 0.1078272485875045, 0.4], Thickness[0.005], 
     LineBox[{{1.2767123365827255`, 1.634117271926733}, {
      0.9857643898205005, -0.5952264388407853}}]}, 
    {LCHColor[1., 0.1078272485875045, 0.4], Thickness[0.005], 
     LineBox[{{3.1489836626291425`, 2.36919287207051}, {1.2767123365827255`, 
      1.634117271926733}}]}, 
    {LCHColor[1., 0.28761514273302685`, 0.4], Thickness[0.005], 
     LineBox[{{1.0297690116794556`, -0.6089165968737547}, {
      3.1489836626291425`, 2.36919287207051}}]}, 
    {LCHColor[1., 0.986293483845558, 0.4], Thickness[0.005], 
     LineBox[{{0.9675458724682812, 1.2384022432287283`}, {
      1.0297690116794556`, -0.6089165968737547}}]}, 
    {LCHColor[1., 0.986293483845558, 0.4], Thickness[0.005], 
     LineBox[{{3.593685872287909, 1.8}, {0.9675458724682812, 
      1.2384022432287283`}}]}, 
    {LCHColor[1., 0.2583187459767014, 0.4], Thickness[0.005], 
     LineBox[{{3.593685872287909, 1.8}, {4.56137345468658, 
      5.681182905103986}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.593685872287909, 1.8}}]}, 
    {LCHColor[1., 0.5838702035996073, 0.4], Thickness[0.005], 
     LineBox[{{1.5492163209293, -2.658770755825441}, {
      2.625570425861098, -6.511232545486238}}]}, 
    {LCHColor[1., 0.1933220866651973, 0.4], Thickness[0.005], 
     LineBox[{{1.5492163209293, -2.658770755825441}, {
      1.7537724954027532`, -1.5386402876537641`}}]}, 
    {LCHColor[1., 0.598333329463974, 0.4], Thickness[0.005], 
     LineBox[{{1.3407528150128805`, -1.515215799555793}, {
      1.5492163209293, -2.658770755825441}}]}, 
    {LCHColor[1., 0.8293266264801983, 0.4], Thickness[0.005], 
     LineBox[{{1.1629252761771016`, -0.6450245633664377}, {
      1.0269123525095545`, 1.3143878725903135`}}]}, 
    {LCHColor[1., 0.20831635865641226`, 0.4], Thickness[0.005], 
     LineBox[{{
      1.1629252761771016`, -0.6450245633664377}, {-1.3397538235238602`, \
-3.7653766787405965`}}]}, 
    {LCHColor[1., 0.839718863864759, 0.4], Thickness[0.005], 
     LineBox[{{1.3407528150128805`, -1.515215799555793}, {
      1.1629252761771016`, -0.6450245633664377}}]}, 
    {LCHColor[1., 0.9684890024260112, 0.4], Thickness[0.005], 
     LineBox[{{1.1869541650110393`, -0.6507082575719074}, {
      1.3407528150128805`, -1.515215799555793}}]}, 
    {LCHColor[1., 0.2709701155526044, 0.4], Thickness[0.005], 
     LineBox[{{2.9896561638409023`, 2.573122770922771}, {4.288828224296603, 
      6.356263259634668}}]}, 
    {LCHColor[1., 0.11207340896600416`, 0.4], Thickness[0.005], 
     LineBox[{{1.7461454298213994`, 2.234964231492087}, {
      1.6836985399379911`, -0.7141385863254888}}]}, 
    {LCHColor[1., 0.11207340896600416`, 0.4], Thickness[0.005], 
     LineBox[{{2.9896561638409023`, 2.573122770922771}, {1.7461454298213994`, 
      2.234964231492087}}]}, 
    {LCHColor[1., 0.28252245903622786`, 0.4], Thickness[0.005], 
     LineBox[{{1.1869541650110393`, -0.6507082575719074}, {
      2.9896561638409023`, 2.573122770922771}}]}, 
    {LCHColor[1., 0.9860546826328037, 0.4], Thickness[0.005], 
     LineBox[{{1.0749586522776886`, 1.375884331936377}, {
      1.1869541650110393`, -0.6507082575719074}}]}, 
    {LCHColor[1., 0.9860546826328037, 0.4], Thickness[0.005], 
     LineBox[{{3.554241094326302, 1.8504870134856726`}, {1.0749586522776886`, 
      1.375884331936377}}]}, 
    {LCHColor[1., 0.2600909007703758, 0.4], Thickness[0.005], 
     LineBox[{{3.554241094326302, 1.8504870134856726`}, {4.385887857597339, 
      5.763077416420895}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.554241094326302, 1.8504870134856726`}}]}, 
    {LCHColor[1., 0.5845951779165256, 0.4], Thickness[0.005], 
     LineBox[{{1.6329400419819924`, -2.6580828648564854`}, {
      2.322960288407771, -6.598117390025333}}]}, 
    {LCHColor[1., 0.19068321928380133`, 0.4], Thickness[0.005], 
     LineBox[{{1.6329400419819924`, -2.6580828648564854`}, {
      1.731921622282341, -1.5322725833292437`}}]}, 
    {LCHColor[1., 0.5985530710901462, 0.4], Thickness[0.005], 
     LineBox[{{1.4922784786483225`, -1.5000357731351905`}, {
      1.6329400419819924`, -2.6580828648564854`}}]}, 
    {LCHColor[1., 0.8299634960221215, 0.4], Thickness[0.005], 
     LineBox[{{1.618380368885712, -0.711540469881188}, {2.0466729659299627`, 
      2.619621936577846}}]}, 
    {LCHColor[1., 0.20572702194721618`, 0.4], Thickness[0.005], 
     LineBox[{{1.618380368885712, -0.711540469881188}, {
      1.6609721487011528`, -1.5155472195944797`}}]}, 
    {LCHColor[1., 0.8400272558255384, 0.4], Thickness[0.005], 
     LineBox[{{1.4922784786483225`, -1.5000357731351905`}, {1.618380368885712,
       -0.711540469881188}}]}, 
    {LCHColor[1., 0.9688446860188232, 0.4], Thickness[0.005], 
     LineBox[{{1.3458724372662108`, -0.682083904530554}, {
      1.4922784786483225`, -1.5000357731351905`}}]}, 
    {LCHColor[1., 0.2643809338852443, 0.4], Thickness[0.005], 
     LineBox[{{2.819795738611797, 2.7905342008355225`}, {3.442029641218006, 
      6.741840942971274}}]}, 
    {LCHColor[1., 0.11996172559400006`, 0.4], Thickness[0.005], 
     LineBox[{{2.0899010394814637`, 2.6749513475959166`}, {
      2.3795405843552455`, -0.6345683268199505}}]}, 
    {LCHColor[1., 0.11996172559400006`, 0.4], Thickness[0.005], 
     LineBox[{{2.819795738611797, 2.7905342008355225`}, {2.0899010394814637`, 
      2.6749513475959166`}}]}, 
    {LCHColor[1., 0.27847849722589324`, 0.4], Thickness[0.005], 
     LineBox[{{1.3458724372662108`, -0.682083904530554}, {2.819795738611797, 
      2.7905342008355225`}}]}, 
    {LCHColor[1., 0.9857873829771755, 0.4], Thickness[0.005], 
     LineBox[{{1.1783162929305095`, 1.5081760792131744`}, {
      1.3458724372662108`, -0.682083904530554}}]}, 
    {LCHColor[1., 0.9857873829771755, 0.4], Thickness[0.005], 
     LineBox[{{3.5124149143654737`, 1.9040220825331367`}, {
      1.1783162929305095`, 1.5081760792131744`}}]}, 
    {LCHColor[1., 0.26205254874366773`, 0.4], Thickness[0.005], 
     LineBox[{{3.5124149143654737`, 1.9040220825331367`}, {4.207007625033196, 
      5.84325309458197}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.5124149143654737`, 1.9040220825331367`}}]}, 
    {LCHColor[1., 0.5849171322417654, 0.4], Thickness[0.005], 
     LineBox[{{1.7160556896852335`, -2.6560126072608092`}, {
      1.9837550201333092`, -6.647044687873247}}]}, 
    {LCHColor[1., 0.18956531690195877`, 0.4], Thickness[0.005], 
     LineBox[{{1.7160556896852335`, -2.6560126072608092`}, {
      1.703936472009831, -1.5249540507694899`}}]}, 
    {LCHColor[1., 0.5986638151981661, 0.4], Thickness[0.005], 
     LineBox[{{1.6523527654575783`, -1.513926819085543}, {
      1.7160556896852335`, -2.6560126072608092`}}]}, 
    {LCHColor[1., 0.828815974698621, 0.4], Thickness[0.005], 
     LineBox[{{2.150583615222927, -0.6827900423515888}, {3.146082113060846, 
      2.372906686160845}}]}, 
    {LCHColor[1., 0.2159167852568263, 0.4], Thickness[0.005], 
     LineBox[{{2.150583615222927, -0.6827900423515888}, {
      5.18601059290601, -3.287820380592153}}]}, 
    {LCHColor[1., 0.8401826774141193, 0.4], Thickness[0.005], 
     LineBox[{{1.6523527654575783`, -1.513926819085543}, {
      2.150583615222927, -0.6827900423515888}}]}, 
    {LCHColor[1., 0.9690239413693432, 0.4], Thickness[0.005], 
     LineBox[{{1.506168701314126, -0.7030706624489125}, {
      1.6523527654575783`, -1.513926819085543}}]}, 
    {LCHColor[1., 0.2563109758136123, 0.4], Thickness[0.005], 
     LineBox[{{2.6317805031850474`, 3.0311827281448025`}, {2.470919783472725, 
      7.0279468979268565`}}]}, 
    {LCHColor[1., 0.11915922822457267`, 0.4], Thickness[0.005], 
     LineBox[{{2.3578483469476015`, 3.017908261655866}, {-1.145402221501851, 
      1.0873033163968446`}}]}, 
    {LCHColor[1., 0.0762729594384182, 0.4], Thickness[0.005], 
     LineBox[{{2.3578483469476015`, 3.017908261655866}, {
      3.0816524108443226`, -0.6289910746358207}}]}, 
    {LCHColor[1., 0.13346905438662546`, 0.4], Thickness[0.005], 
     LineBox[{{2.6317805031850474`, 3.0311827281448025`}, {
      2.3578483469476015`, 3.017908261655866}}]}, 
    {LCHColor[1., 0.27530388471357115`, 0.4], Thickness[0.005], 
     LineBox[{{1.506168701314126, -0.7030706624489125}, {2.6317805031850474`, 
      3.0311827281448025`}}]}, 
    {LCHColor[1., 0.9854894071207162, 0.4], Thickness[0.005], 
     LineBox[{{1.2783638257606833`, 1.6362310816807177`}, {
      1.506168701314126, -0.7030706624489125}}]}, 
    {LCHColor[1., 0.9854894071207162, 0.4], Thickness[0.005], 
     LineBox[{{3.46787308208982, 1.9610330280369075`}, {1.2783638257606833`, 
      1.6362310816807177`}}]}, 
    {LCHColor[1., 0.2642127512880467, 0.4], Thickness[0.005], 
     LineBox[{{3.46787308208982, 1.9610330280369075`}, {4.024565485930083, 
      5.922105303003189}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.46787308208982, 1.9610330280369075`}}]}, 
    {LCHColor[1., 0.5848291029435593, 0.4], Thickness[0.005], 
     LineBox[{{1.8066467639556176`, -2.6521797168353647`}, {
      1.621703659564958, -6.647901935425935}}]}, 
    {LCHColor[1., 0.190135086703219, 0.4], Thickness[0.005], 
     LineBox[{{1.8066467639556176`, -2.6521797168353647`}, {
      1.6740918656971036`, -1.518184786621139}}]}, 
    {LCHColor[1., 0.5986805613908182, 0.4], Thickness[0.005], 
     LineBox[{{1.8215391649987465`, -1.5620324607768548`}, {
      1.8066467639556176`, -2.6521797168353647`}}]}, 
    {LCHColor[1., 0.8281600103931798, 0.4], Thickness[0.005], 
     LineBox[{{3.0423343724160086`, -0.6247797326815431}, {4.248532477419644, 
      0.9618345673915898}}]}, 
    {LCHColor[1., 0.22093959254086767`, 0.4], Thickness[0.005], 
     LineBox[{{3.0423343724160086`, -0.6247797326815431}, {
      5.578645156888232, -3.717857100703541}}]}, 
    {LCHColor[1., 0.8402061795210143, 0.4], Thickness[0.005], 
     LineBox[{{1.8215391649987465`, -1.5620324607768548`}, {
      3.0423343724160086`, -0.6247797326815431}}]}, 
    {LCHColor[1., 0.9690510475033614, 0.4], Thickness[0.005], 
     LineBox[{{1.667558613001596, -0.7136556896639912}, {
      1.8215391649987465`, -1.5620324607768548`}}]}, 
    {LCHColor[1., 0.2681920794990198, 0.4], Thickness[0.005], 
     LineBox[{{2.5657510233573957`, 3.1156966083282667`}, {6.351422600408173, 
      4.407474728095697}}]}, 
    {LCHColor[1., 0.077004492907637, 0.4], Thickness[0.005], 
     LineBox[{{2.5657510233573957`, 3.1156966083282667`}, {
      0.04861027552410313, -0.04640352334960962}}]}, 
    {LCHColor[1., 0.27286965557260023`, 0.4], Thickness[0.005], 
     LineBox[{{2.3614289481841846`, 3.0224912222468503`}, {
      2.5657510233573957`, 3.1156966083282667`}}]}, 
    {LCHColor[1., 0.27286965557260023`, 0.4], Thickness[0.005], 
     LineBox[{{1.667558613001596, -0.7136556896639912}, {2.3614289481841846`, 
      3.0224912222468503`}}]}, 
    {LCHColor[1., 0.985158714248841, 0.4], Thickness[0.005], 
     LineBox[{{1.375828946550809, 1.7609807474667265`}, {
      1.667558613001596, -0.7136556896639912}}]}, 
    {LCHColor[1., 0.985158714248841, 0.4], Thickness[0.005], 
     LineBox[{{3.420222274756911, 2.022023280149909}, {1.375828946550809, 
      1.7609807474667265`}}]}, 
    {LCHColor[1., 0.2665784087481894, 0.4], Thickness[0.005], 
     LineBox[{{3.420222274756911, 2.022023280149909}, {3.838336127827525, 
      6.0001108616230034`}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.420222274756911, 2.022023280149909}}]}, 
    {LCHColor[1., 0.8928220793946443, 0.4], Thickness[0.005], 
     LineBox[{{1.4714430243140337`, 
      1.8833611862196245`}, {-1.5612499167537668`, -0.7248515208266268}}]}, 
    {LCHColor[1., 0.3105246701371981, 0.4], Thickness[0.005], 
     LineBox[{{1.9157894559941464`, -2.64537267360379}, {
      1.256785730266893, -6.590713481376625}}]}, 
    {LCHColor[1., 0.12337661360929908`, 0.4], Thickness[0.005], 
     LineBox[{{1.9157894559941464`, -2.64537267360379}, {
      1.6488964018230425`, -1.5133020830855093`}}]}, 
    {LCHColor[1., 0.3225335388609307, 0.4], Thickness[0.005], 
     LineBox[{{2.0006496149755897`, -1.6503900221851238`}, {
      1.9157894559941464`, -2.64537267360379}}]}, 
    {LCHColor[1., 0.4526532009393739, 0.4], Thickness[0.005], 
     LineBox[{{2.0006496149755897`, -1.6503900221851238`}, {
      5.811899558680485, -0.4361520444355187}}]}, 
    {LCHColor[1., 0.5220671654380268, 0.4], Thickness[0.005], 
     LineBox[{{1.829839843851806, -0.7137657068421941}, {
      2.0006496149755897`, -1.6503900221851238`}}]}, 
    {LCHColor[1., 0.1687851829298539, 0.4], Thickness[0.005], 
     LineBox[{{2.749091778476614, 2.8810311429734634`}, {6.693813133634008, 
      3.5437327577030566`}}]}, 
    {LCHColor[1., 0.050632946927093476`, 0.4], Thickness[0.005], 
     LineBox[{{2.749091778476614, 2.8810311429734634`}, {
      0.6454403284104253, -0.45758923221008896`}}]}, 
    {LCHColor[1., 0.17206491105065744`, 0.4], Thickness[0.005], 
     LineBox[{{2.0785002939477195`, 2.660359058749238}, {2.749091778476614, 
      2.8810311429734634`}}]}, 
    {LCHColor[1., 0.17206491105065744`, 0.4], Thickness[0.005], 
     LineBox[{{1.829839843851806, -0.7137657068421941}, {2.0785002939477195`, 
      2.660359058749238}}]}, 
    {LCHColor[1., 0.5348540256250167, 0.4], Thickness[0.005], 
     LineBox[{{1.4714430243140337`, 1.8833611862196245`}, {
      1.829839843851806, -0.7137657068421941}}]}, 
    {LCHColor[1., 0.9847934994618045, 0.4], Thickness[0.005], 
     LineBox[{{3.368995919383103, 2.0875900250583634`}, {1.4714430243140337`, 
      1.8833611862196245`}}]}, 
    {LCHColor[1., 0.26915359856676785`, 0.4], Thickness[0.005], 
     LineBox[{{3.368995919383103, 2.0875900250583634`}, {3.6480218143596046`, 
      6.077846226097661}}]}, 
    {LCHColor[1., 1., 0.4], Thickness[0.005], 
     LineBox[{{5, 1.8}, {3.368995919383103, 2.0875900250583634`}}]}}},
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{"ScalingFunctions" -> None},
  PlotRange->{{-2.220446049250313*^-16, 5.}, {-2.658770813460687, 
   3.199854080482697}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.05], 
     Scaled[0.05]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.733995663449001*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"373baf17-4024-490e-9de6-7aa5778cbe6b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"<<", "rayTrace2D`"}], "\[IndentingNewLine]", 
 RowBox[{"??", "\"\<rayTrace2D`*\>\""}]}], "Input",
 CellChangeTimes->{{3.7339927435416317`*^9, 3.7339927527251005`*^9}, {
   3.7339928266378546`*^9, 3.7339928391012683`*^9}, {3.733993364161248*^9, 
   3.733993368953163*^9}, 3.733994308057661*^9, 3.7339943907938294`*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"c31cbddf-18cd-4c5c-9f4e-666c880d1e1a"],

Cell[BoxData[
 DynamicModuleBox[{Typeset`open$$ = True}, 
  PaneSelectorBox[{False->
   RowBox[{
    OpenerBox[Dynamic[Typeset`open$$],
     ImageSize->Small], 
    StyleBox["rayTrace2D`", "InfoHeading"]}], True->GridBox[{
     {
      RowBox[{
       OpenerBox[Dynamic[Typeset`open$$],
        ImageSize->Small], 
       StyleBox["rayTrace2D`", "InfoHeading"]}]},
     {GridBox[{
        {
         ButtonBox["boundaryPlot",
          BaseStyle->"InformationLinkLF",
          
          ButtonData:>{
           "Info263734027984-2949273", {"boundaryPlot", "rayTrace2D`"}},
          ButtonNote->"rayTrace2D`"], 
         ButtonBox["crossArc",
          BaseStyle->"InformationLinkLF",
          
          ButtonData:>{
           "Info263734027984-2949273", {"crossArc", "rayTrace2D`"}},
          ButtonNote->"rayTrace2D`"], 
         ButtonBox["crossLine",
          BaseStyle->"InformationLinkLF",
          
          ButtonData:>{
           "Info263734027984-2949273", {"crossLine", "rayTrace2D`"}},
          ButtonNote->"rayTrace2D`"], 
         ButtonBox["crossPoint",
          BaseStyle->"InformationLinkLF",
          
          ButtonData:>{
           "Info263734027984-2949273", {"crossPoint", "rayTrace2D`"}},
          ButtonNote->"rayTrace2D`"], 
         ButtonBox["rayTrace",
          BaseStyle->"InformationLinkLF",
          
          ButtonData:>{
           "Info263734027984-2949273", {"rayTrace", "rayTrace2D`"}},
          ButtonNote->"rayTrace2D`"], 
         ButtonBox["refract",
          BaseStyle->"InformationLinkLF",
          ButtonData:>{"Info263734027984-2949273", {"refract", "rayTrace2D`"}},
          ButtonNote->"rayTrace2D`"], 
         ButtonBox["Refracted",
          BaseStyle->"InformationLinkLF",
          
          ButtonData:>{
           "Info263734027984-2949273", {"Refracted", "rayTrace2D`"}},
          ButtonNote->"rayTrace2D`"]}
       },
       DefaultBaseStyle->"InfoGrid",
       GridBoxItemSize->{"Columns" -> {{
            Scaled[0.1357142857142857]}}}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}}]}, 
   Dynamic[Typeset`open$$],
   ImageSize->Automatic]]], "Print", "InfoCell",
 CellChangeTimes->{
  3.733995584409373*^9},ExpressionUUID->"5b03a951-11ec-49a6-9e02-\
573af318f60c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:5149\:7dda\:8ffd\:8de1\:4e8c\:6b21\:5143\:30e2\:30b8\:30e5\:30fc\:30eb\
 ver.2.0", "Subsection",
 CellChangeTimes->{{3.641730091096057*^9, 3.6417300935467834`*^9}, 
   3.654465792062807*^9, {3.6858466148789*^9, 3.6858466152041163`*^9}, 
   3.686060333805935*^9, {3.686128653947929*^9, 
   3.6861286566672096`*^9}},ExpressionUUID->"c6e203fc-1b77-47a6-9964-\
cc3565f21d0b"],

Cell["\<\
\:ff12\:6b21\:5143\:306e\:5883\:754c\:9762\:3067\:306e\:5c48\:6298\:53cd\:5c04\
\:3092\:8a08\:7b97\:3059\:308b\:3002
rayTrace[boundary, ray, recursive] : \:30ec\:30a4\:30c8\:30ec\:30fc\:30b9\
\:8a08\:7b97\:3092\:518d\:5e30\:7684\:306b\:884c\:3044\:3001Graphics\:30aa\
\:30d6\:30b8\:30a7\:30af\:30c8\:3092\:51fa\:529b\:3059\:308b\:3002
refract[normal-vector, ray-vector] \:ff1a\:4ea4\:70b9\:3068\:305d\:306e\:6cd5\
\:7dda\:30d9\:30af\:30c8\:30eb\:3092\:5143\:306b\:3001\:5149\:7dda\:306e\:53cd\
\:5c04\:5c48\:6298\:30d9\:30af\:30c8\:30eb\:53ca\:3073\:3001\:53cd\:5c04\:7387\
\:3092\:8fd4\:3059\:3002
crossLine : line\:3068ray\:306e\:4ea4\:70b9\:ff08\:3067\:6700\:3082\:5149\
\:7dda\:306e\:59cb\:70b9\:306b\:8fd1\:3044\:3082\:306e\:ff09\:3092\:6c42\:3081\
\:3001\:4ea4\:70b9\:3068\:3001\:305d\:3053\:3067\:306e\:5883\:754c\:9762\:306e\
\:6cd5\:7dda\:30d9\:30af\:30c8\:30eb\:3092\:8fd4\:3059\:3002
crossArc : \
\:5186\:5f27line\:3068ray\:306e\:4ea4\:70b9\:3092\:6c42\:3081\:3001\:4ea4\
\:70b9\:3068\:3001\:305d\:3053\:3067\:306e\:5883\:754c\:9762\:306e\:6cd5\:7dda\
\:30d9\:30af\:30c8\:30eb\:3092\:8fd4\:3059\:3002
crossPoint : \:95a2\:6570\:66f2\:7dda(func\:578b)\:3068ray\:306e\:4ea4\:70b9\
\:3092\:6c42\:3081\:3001\:4ea4\:70b9\:3068\:3001\:305d\:3053\:3067\:306e\:5883\
\:754c\:9762\:306e\:6cd5\:7dda\:30d9\:30af\:30c8\:30eb\:3092\:8fd4\:3059\:3002\

v2p : v(\:5883\:754c\:30c7\:30fc\:30bf)\:3000\:304b\:3089\:3001parametric\
\:306a\:5ea7\:6a19\:5024{x[t],y[t]}\:306e\:8868\:5f0f\:3092\:3001parametric\
\:3078\:306e\:4ee3\:5165\:898f\:5247\:3067\:8fd4\:3059\:3002
v2f :  v(\:5883\:754c\:30c7\:30fc\:30bf)\:3000\:304b\:3089\:3001f[x,y]==0 \
\:306a\:63cf\:753b\:5f0f\:3092\:8fd4\:3059\:3002\:4f46\:3057\:3001==0\:306e\
\:90e8\:5206\:306f\:8fd4\:3055\:306a\:3044\:3002\:300c\:591a\:5206\:4f7f\:3063\
\:3066\:3044\:306a\:3044\:300d
v2\[Theta]c: v(arc\:306e\:5883\:754c\:30c7\:30fc\:30bf)\:304b\:3089\:3001arc\
\:306e\:4e2d\:5fc3\:70b9(center), \:305d\:306e\:59cb\:70b9\:7d42\:70b9\:306e\
\:4f4d\:76f8\:89d2(start, end)\:3092\:8fd4\:3059\:3002

\:6b8b\:3063\:305f\:5b9f\:88c5\:3002(boundary\:306b\:6307\:5b9a\:3055\:308c\
\:305freflectivity\:306a\:3069\:304crefract\:306b\:6e21\:3063\:3066\:3044\
\:306a\:3044\:ff1f)
    \
\>", "Text",
 CellChangeTimes->{{3.6862574774598722`*^9, 3.6862574983654547`*^9}, {
   3.6862575552800264`*^9, 3.686257708880333*^9}, {3.6862577896619577`*^9, 
   3.686257932623141*^9}, {3.686257981102923*^9, 3.686258407874634*^9}, {
   3.6862584432575026`*^9, 3.6862584862000165`*^9}, {3.686258739251445*^9, 
   3.6862587836716037`*^9}, {3.6862640399998555`*^9, 3.686264457691373*^9}, {
   3.7339944953146915`*^9, 3.73399451426748*^9}, {3.733994624562109*^9, 
   3.733994627361555*^9}, 
   3.7669760044220915`*^9},ExpressionUUID->"d273dc19-d4c8-4d4d-ac11-\
a90c679ffd2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<rayTrace2D`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"bed8a486-e72e-4601-9e61-0d364b853f00"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rayTrace", "::", "usage"}], "=", 
   "\"\<\:5149\:7dda\:8ffd\:8de1\:3092\:4e8c\:6b21\:5143\:3067\:304a\:3053\
\:306a\:3046\:3002 rayTrace[boundary, ray, recursivecount, options]\\n\:5149\
\:7dda\:304c\:6700\:521d\:306b\:63a5\:89e6\:3059\:308b\:5883\:754c\:3092\:63a2\
\:3057\:3001\:305d\:3053\:307e\:3067\:306e\:7dda\:5206\:3092\:63cf\:304f\:30b0\
\:30e9\:30d5\:30a3\:30c3\:30af\:30b9\:60c5\:5831\:3092\:8fd4\:3059\:3068\:540c\
\:6642\:306b\:3001\\n\:305d\:3053\:3067\:306e\:53cd\:5c04\:5c48\:6298\:3092\
\:8a08\:7b97\:3057\:3066\:3001\:518d\:5e30\:7684\:306b\:81ea\:5206\:3092\:8aad\
\:307f\:51fa\:3059\:3002\\n\:7121\:9650\:518d\:5e30\:306b\:306a\:3089\:306a\
\:3044\:3088\:3046\:3001\:518d\:5e30\:7684\:306b\:547c\:3073\:51fa\:3059\:30cd\
\:30b9\:30c8\:306e\:6df1\:3055\:306e\:6700\:5927\:5024\:306frecursivecount\
\:3067\:5236\:9650\:3059\:308b\:3002\\n\nrayTrace[]\:3067\:30c7\:30e2\:3092\
\:5b9f\:884c\:3002(??rayTrace\:3067\:4e2d\:8eab\:3092\:307f\:308b\:3053\:3068\
\:304c\:3067\:304d\:308b\:ff09\\n\nboundary: \:5883\:754c\:9762\:30c7\:30fc\
\:30bf\:3002 \:4ee3\:5165\:898f\:5247\:30fb\:9806\:4e0d\:540c\:306e\:30ea\
\:30b9\:30c8\:5f62\:5f0f\:3067\:3001\:57fa\:672c\:5f62\:306f{type \[Rule] \
\\\"line\\\"|\\\"arc\\\"|\\\"func\\\", opts}\:3002\\\"line\\\"\:306f\:7dda\
\:5206\:30c7\:30fc\:30bf\:3001\\\"arc\\\"\:306f\:5186\:5f27\:30c7\:30fc\:30bf\
\:3001\\\"func\\\"\:306f\:4efb\:610f\:95a2\:6570\:30c7\:30fc\:30bf\:3002\:3053\
\:308c\:3089\:3092\:8907\:6570\:542b\:3080\:30ea\:30b9\:30c8\:3002\nopts:\n\
\\t\!\(TraditionalForm\`pos \[Rule] {x, \\\ y}\) : \:539f\:70b9\:5ea7\:6a19\
\:3002\:5883\:754c\:306e\:63cf\:753b\:958b\:59cb\:70b9\:3002 (\\\"line\\\", \
\\\"arc\\\"\:3067\:5fc5\:9808)\n\
\\t\!\(TraditionalForm\`\(\(vec\)\(\[Rule]\)\({x, \\\ y}\)\(\\\ \)\)\): \
\:63cf\:753b\:30d9\:30af\:30c8\:30eb\:3002pos + vec\:3067\:63cf\:753b\:7d42\
\:4e86\:70b9\:3002(\\\"line\\\", \\\"arc\\\"\:3067\:5fc5\:9808)\n\
\\tri\!\(TraditionalForm\`\(\(\\\ \)\(\(\[Rule]\)\(\\\ \
\)\({\*SubscriptBox[\(n\), \(in\)], \\\ \*SubscriptBox[\(n\), \(out\)]}\)\)\)\
\) : \:5c48\:6298\:7387\:3002\:5883\:754c\:9762\:306e\:6cd5\:7dda\:30d9\:30af\
\:30c8\:30eb\:3000(vec\:309290\:5ea6\:307f\:3060\:308a\:56de\:8ee2\:3057\:305f\
\:3082\:306e)\:304c\:6307\:3059\:65b9\:304c \
\!\(TraditionalForm\`\*SubscriptBox[\(n\), \(in\)]\)\n\
\\t\!\(TraditionalForm\`cuv \[Rule] \\\ C\) : \:66f2\:7387\:3002\\\"arc\\\"\
\:3067\:5fc5\:9808\:3002\:5186\:5f27\:306e\:534a\:5f84\!\(TraditionalForm\`r\)\
\:3068\:306e\:95a2\:4fc2\:306f \!\(TraditionalForm\`r \[Equal] 1/C\)\:3067\
\:3001\:6cd5\:7dda\:65b9\:5411\:306b\:81a8\:3089\:3080\:3068\:304d\:306f\:6b63\
\:3001\:9006\:65b9\:5411\:3067\:8ca0\:3068\:306a\:308b\:3002\n\\tfunction \
\[Rule] Function[{x,y},.....] : type==\\\"func\\\"\:306e\:6642\:306b\:5fc5\
\:9808\:3002\:7d14\:95a2\:6570f\:3092\:6307\:5b9a\:3057\:3001f==0\:304c\:5883\
\:754c\:306e\:63cf\:753b\:65b9\:7a0b\:5f0f\:3068\:306a\:308b\:3088\:3046\:306b\
\:3059\:308b\:3002\n\\tparametric \[Rule] \
{Function[{t},fx[...]],Function[{t},fy[...]]} : \
type==\\\"func\\\"\:306e\:6642\:306b\:5fc5\:9808\:3002t\:3092\:5a92\:4ecb\
\:5909\:6570\:3068\:3059\:308bParametric\:306a\:95a2\:6570\:30d9\:30af\:30c8\
\:30eb\:3092\:6307\:5b9a\:3057\:3001t==0\:304c\:59cb\:70b9\:3001t==1\:304c\
\:7d42\:70b9\:3068\:306a\:308b\:3088\:3046\:306b\:8a2d\:5b9a\:3059\:308b\:3002\
\n\\treflectivity \[Rule] R : \:5883\:754c\:9762\:306e\:53cd\:5c04\:7387(0-1)\
\:3002\:30d5\:30ec\:30cd\:30eb\:53cd\:5c04\:3092\:7121\:8996\:3057\:3066\:3001\
\:5f37\:5236\:7684\:306b\:3053\:306e\:53cd\:5c04\:5229\:3092\:5229\:7528\:3059\
\:308b\:3002\n\\tabsorbance \[Rule] A : \:5883\:754c\:9762\:306e\:5438\:53ce\
\:7387\:3002\:5165\:5c04\:5149\:306f\:5f37\:5236\:7684\:306b\:3053\:308c\:3060\
\:3051\:306e\:5149\:3092\:6e1b\:8870\:3059\:308b\:3002(0-1)\:3002\\n\nray: \
\:5149\:7dda\:30c7\:30fc\:30bf\:3002type \[Rule] \\\"ray\\\"\:3067\:3001{pos \
\[Rule] {x,y}, vec \[Rule] {xd,yd}, opts}\:3067\:4e0e\:3048\:308b\:3002\n\
opts:\n\\tpow \[Rule] Number : \:5149\:7dda\:306e\:5f37\:5ea6\:3002\:30c7\
\:30d5\:30a9\:30eb\:30c8\:306f1\:3002\n\\t\[Pi]powerFraction \[Rule] [0..1] : \
\[Pi]\:504f\:5149\:306e\:5f37\:5ea6\:3067\:306e\:542b\:6709\:7387\:3002\n\\t\
\[Sigma]powerFraction \[Rule] [0..1] : \[Sigma]\:504f\:5149\:306e\:5f37\:5ea6\
\:3067\:306e\:542b\:6709\:7387\:3002\n\\tcolor \[Rule] Number : \:5149\:306e\
\:63cf\:753b\:6642\:306e\:8272\:3002LCHColor\:306eh\:3092\:6307\:5b9a\:3059\
\:308b\:3002\\n\nrecursivecount: \:518d\:5e30\:3067\:547c\:3073\:51fa\:3059\
\:6bce\:306b\:3053\:3053\:3067\:306e\:6570\:5024\:3092\:4e00\:3064\:6e1b\:3089\
\:3057\:3066rayTrace\:3092\:547c\:3073\:51fa\:3059\:3088\:3046\:306b\:306a\
\:3063\:3066\:3044\:308b\:305f\:3081\:3001\:4f8b\:3068\:3057\:30665\:3068\
\:8a2d\:5b9a\:3059\:308b\:3068\:30015\:56de\:306e\:53cd\:5c04\:5c48\:6298\
\:307e\:3067\:3092\:8a08\:7b97\:3059\:308b\:3002\\n\noptions: rayTrace\:3067\
\:306f\:4e0a\:8a18\:ff13\:3064\:306e\:5f15\:6570\:5f8c\:306b\:30aa\:30d7\:30b7\
\:30e7\:30f3\:3092\:8a2d\:5b9a\:3067\:304d\:308b\:3002\n\\tpowerDescription \
\[Rule] True|False : \:5149\:7dda\:304c\:5f31\:304f\:306a\:308b\:3068\:305d\
\:308c\:306b\:5fdc\:3058\:3066\:8272\:3092\:8584\:304f\:3059\:308b(True)\:3002\
\n\\tgammaFactor \[Rule] (0...1): \:5149\:7dda\:304c\:5f31\:304f\:306a\:308b\
\:3068\:3001\:307f\:3048\:306b\:304f\:304f\:306a\:308b\:305f\:3081\:3001\:8272\
\:306e\:6fc3\:6de1\:306b\:30ac\:30f3\:30de\:88dc\:6b63\:3092\:304b\:3051\:308b\
\:30020.1\:304c\:30c7\:30d5\:30a9\:30eb\:30c8\:3002\n\\tcolorShift \[Rule] \
(0...1) : \:5149\:7dda\:304c\:5f31\:304f\:306a\:308b\:3068\:3001\:307f\:3048\
\:306b\:304f\:304f\:306a\:308b\:305f\:3081\:30011%\:3092\:4e0b\:56de\:308b\
\:3068\:3053\:3053\:306b\:6307\:5b9a\:3057\:305f\:5024\:3060\:3051\:8272\:76f8\
\:3092\:5897\:3084\:3059\:3002\n\\tdisplayThickness : \
\:5149\:7dda\:63cf\:753b\:306e\:6642\:306e\:7dda\:306e\:592a\:3055\:3002(0.01\
\:304c\:30c7\:30d5\:30a9\:30eb\:30c8)\n\\tterminatePower \[Rule] 0.1 \:ff1a \
\:3053\:306e\:5024\:3092\:4e0b\:56de\:3063\:305f\:3068\:304d\:306b\:3001\:5149\
\:7dda\:8ffd\:8de1\:3092\:3084\:3081\:308b\:3002\:305f\:3060\:3057\:3001\
recursivecount\:3088\:308a\:6df1\:3044\:3068\:3053\:308d\:306f\:63a2\:7d22\
\:3055\:308c\:306a\:3044\:3002\n\\textensLengthion \[Rule] \:6b63\:6570 : \
\:5149\:7dda\:304c\:5168\:3066\:306e\:5883\:754c\:3068\:4ea4\:70b9\:3092\:6301\
\:305f\:306a\:304b\:3063\:305f\:3068\:304d\:3001\:3053\:306e\:9577\:3055\:3060\
\:3051\:9032\:3093\:3060\:63cf\:753b\:3092\:304a\:3053\:306a\:3063\:3066\:3001\
\:8ffd\:8de1\:3092\:3084\:3081\:308b\:3002\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"refract", "::", "usage"}], "=", 
   "\"\<refract[bd, ray] ray(e)\:304c,\:3000d\:3092\:6cd5\:7dda\:3068\:3059\
\:308b\:9762\:3067\:5c48\:6298\:30fb\:53cd\:5c04\:3055\:308c\:305f\:3068\:304d\
\:5411\:304d\:306e\:307f\:3092\:8a08\:7b97\:3002\[IndentingNewLine]\:8fd4\
\:3059\:5024\:306f\:3001status \[Rule] \\\"Refracted\\\"\:306e\:6642\:3001vec \
\[Rule] {x,y}\:3067\:5358\:4f4d\:30d9\:30af\:30c8\:30eb\:3092\:8fd4\:3059\
\:3002\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boundaryPlot", "::", "usage"}], "=", 
   "\"\<boundaryPlor[prism_List] \:3067\:3001\:5883\:754c\:306e\:30d1\:30bf\
\:30fc\:30f3\:3092\:30d7\:30ed\:30c3\:30c8\:3059\:308b\:3002\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"crossLine", "::", "usage"}], "=", 
   "\"\<\:7dda\:5206\:30c7\:30fc\:30bf\:3068\:5149\:7dda\:30c7\:30fc\:30bf\
\:306e\:4ea4\:70b9\:3092\:6c42\:3081\:308b\\n\:7d50\:679c\:51fa\:529b\:306f\
\:4ee5\:4e0b\:306e\:901a\:308a\n\:4ea4\:70b9\:304c\:306a\:3044\:5834\:5408{}\
\:3092\:8fd4\:3057\:3001\:3055\:3082\:306a\:304f\:3070\:4ee5\:4e0b\:306e\:30ea\
\:30b9\:30c8\:3092\:8fd4\:3059\:3002\\n{cross\[Rule]\:4ea4\:70b9\:306e\:6570,\
\\n pos\[Rule]\:4ea4\:70b9\:5ea7\:6a19,\\n\:3000tangent\[Rule]\:6cd5\:7dda\
\:30d9\:30af\:30c8\:30eb,\\n\:3000rayinfo\[Rule] {parametric\[Rule]{\:5149\
\:7dda\:5f0f\:3068\:3001\:5a92\:4ecb\:7de8\:6570\:5024},\\n  objinfo \[Rule] \
{parametric\[Rule](\:5883\:754c\:306e\:5f0f\:3068\:3001\:5a92\:4ecb\:7de8\
\:6570\:5024}}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"crossArc", "::", "usage"}], "=", 
   "\"\<\:5186\:5f27\:30c7\:30fc\:30bf\:3068\:5149\:7dda\:30c7\:30fc\:30bf\
\:306e\:4ea4\:70b9\:3092\:6c42\:3081\:308b\\n\:7d50\:679c\:51fa\:529b\:306f\
\:4ee5\:4e0b\:306e\:901a\:308a\n\:4ea4\:70b9\:304c\:306a\:3044\:5834\:5408{}\
\:3092\:8fd4\:3057\:3001\:3055\:3082\:306a\:304f\:3070\:4ee5\:4e0b\:306e\:30ea\
\:30b9\:30c8\:3092\:8fd4\:3059\:3002\\n\n cross\[Rule]\:4ea4\:70b9\:6570, \
\\npos\[Rule]\:4ea4\:70b9\:5ea7\:6a19, \\ntangent\[Rule]\:6cd5\:7dda\:30d9\
\:30af\:30c8\:30eb, \\nrayinfo \[Rule] {parametric\[Rule]\:4ea4\:70b9\:3092\
\:5f53\:305f\:308b\:5a92\:4ecb\:5909\:6570,{}}, \\nobjinfo \[Rule] \
{parametric\[Rule]\:4ea4\:70b9\:3092\:4e0e\:3048\:308b\:5883\:754c\:306e\:5a92\
\:4ecb\:5909\:6570, {}, other \[Rule] \:4ed6\:306e\:4ea4\:70b9\:306e\:60c5\
\:5831}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"crossPoint", "::", "usage"}], "=", 
   "\"\<\:95a2\:6570\:578b\:5883\:754c\:3068\:5149\:7dda\:30c7\:30fc\:30bf\
\:306e\:4ea4\:70b9\:3092\:6c42\:3081\:308b\\n\:7d50\:679c\:51fa\:529b\:306f\
\:4ee5\:4e0b\:306e\:901a\:308a\n\:4ea4\:70b9\:304c\:306a\:3044\:5834\:5408{}\
\:3092\:8fd4\:3057\:3001\:3055\:3082\:306a\:304f\:3070\:4ee5\:4e0b\:306e\:30ea\
\:30b9\:30c8\:3092\:8fd4\:3059\:3002\\n\n cross\[Rule]\:4ea4\:70b9\:6570, \
\\npos\[Rule]\:4ea4\:70b9\:5ea7\:6a19,\\ntangent\[Rule]\:6cd5\:7dda\:30d9\
\:30af\:30c8\:30eb,\\nrayinfo \[Rule] {parametric\[Rule]\:4ea4\:70b9\:3092\
\:5f53\:305f\:308b\:5a92\:4ecb\:5909\:6570,{}},\\nobjinfo \[Rule] {parametric\
\[Rule]\:4ea4\:70b9\:3092\:4e0e\:3048\:308b\:5883\:754c\:306e\:5a92\:4ecb\
\:5909\:6570, {}, other \[Rule] \:4ed6\:306e\:4ea4\:70b9\:306e\:60c5\:5831}\>\
\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.767657144234951*^9, 3.7676571773082085`*^9}, 
   3.7676577410905266`*^9, {3.767657773727859*^9, 3.7676578471990128`*^9}, {
   3.767657916875513*^9, 3.767657997291106*^9}, {3.767658065440153*^9, 
   3.7676581692765045`*^9}, {3.767658200933525*^9, 3.7676582740623627`*^9}, {
   3.7676583430555725`*^9, 3.7676583442355766`*^9}, {3.767658391524042*^9, 
   3.7676584065446277`*^9}, {3.7676653636288905`*^9, 
   3.7676654901275873`*^9}, {3.767674257976284*^9, 3.767674266516943*^9}, {
   3.7676745290144544`*^9, 3.767674530796873*^9}, {3.7680289475884256`*^9, 
   3.768029144011407*^9}},ExpressionUUID->"a7d6b389-5ad1-40da-97c2-\
3092f31aaaed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d1227785-abb2-48fc-828c-8a018c31f534"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rayTrace", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prism", ",", "work"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"prism", "[", 
        RowBox[{"\[Theta]_", ",", "L_", ",", "n_"}], "]"}], ":=", 
       RowBox[{"N", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Global`type", "\[Rule]", "\"\<line\>\""}], ",", 
            RowBox[{"Global`org", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", 
            RowBox[{"Global`vec", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               FractionBox["L", "2"], ",", 
               RowBox[{
                FractionBox["1", "2"], " ", "L", " ", 
                RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}], "}"}]}], ",", 
            RowBox[{"Global`ri", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1"}], "}"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Global`type", "\[Rule]", "\"\<line\>\""}], ",", 
            RowBox[{"Global`org", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               FractionBox["L", "2"], ",", 
               RowBox[{
                FractionBox["1", "2"], " ", "L", " ", 
                RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}], "}"}]}], ",", 
            RowBox[{"Global`vec", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               FractionBox["L", "2"], ",", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", "2"]}], " ", "L", " ", 
                RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}], "}"}]}], ",", 
            RowBox[{"Global`ri", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1"}], "}"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Global`type", "\[Rule]", "\"\<arc\>\""}], ",", 
            RowBox[{"Global`org", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"L", ",", "0"}], "}"}]}], ",", 
            RowBox[{"Global`vec", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["L", "2"]}], ",", 
               RowBox[{"-", "0.5`"}]}], "}"}]}], ",", 
            RowBox[{"Global`cuv", "\[Rule]", "0.4`"}], ",", 
            RowBox[{"Global`ri", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1"}], "}"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Global`type", "\[Rule]", "\"\<arc\>\""}], ",", 
            RowBox[{"Global`org", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               FractionBox["L", "2"], ",", 
               RowBox[{"-", "0.6`"}]}], "}"}]}], ",", 
            RowBox[{"Global`vec", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["L", "2"]}], ",", "0.6`"}], "}"}]}], ",", 
            RowBox[{"Global`cuv", "\[Rule]", "0.4`"}], ",", 
            RowBox[{"Global`ri", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1"}], "}"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Global`type", "\[Rule]", "\"\<arc\>\""}], ",", 
            RowBox[{"Global`org", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0.3`", ",", 
               RowBox[{"-", "2.5"}]}], "}"}]}], ",", 
            RowBox[{"Global`vec", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               FractionBox["L", "2"], ",", "0"}], "}"}]}], ",", 
            RowBox[{"Global`cuv", "\[Rule]", 
             RowBox[{"-", "0.2"}]}], ",", 
            RowBox[{"Global`ri", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1.5`"}], "}"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Global`type", "\[Rule]", "\"\<func\>\""}], ",", 
            RowBox[{"Global`function", "\[Rule]", " ", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], ",", 
               RowBox[{
                RowBox[{"0.6", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"x", "-", "1.5"}], ")"}], "2"]}], "+", "y", "+", 
                "1.5"}]}], "]"}]}], ",", 
            RowBox[{"Global`parametric", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"2.5", "Global`t"}], "+", "0.25"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "3.75"}], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"Global`t", "-", "0.5"}], ")"}], "2"]}], "-", 
                "1.5"}]}], "}"}]}], ",", 
            RowBox[{"Global`ri", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"1.5", ",", "1"}], "}"}]}], ",", 
            RowBox[{"Global`reflectivity", "\[Rule]", "0.7"}], ",", 
            RowBox[{"Global`absorbance", "\[Rule]", "0."}]}], "}"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"work", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"rayTrace", "[", 
           RowBox[{
            RowBox[{"prism", "[", 
             RowBox[{
              RowBox[{"52", " ", "\[Degree]"}], ",", "5", ",", "1.408`"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Global`type", "\[Rule]", "\"\<ray\>\""}], ",", 
              RowBox[{"Global`org", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"5", ",", "1.8`"}], "}"}]}], ",", 
              RowBox[{"Global`vec", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "}"}]}], ",", 
              RowBox[{"Global`color", "\[Rule]", "0.4`"}], ",", 
              RowBox[{"Global`pow", "\[Rule]", "1"}], ",", 
              RowBox[{"Global`\[Pi]powerFraction", "\[Rule]", "0.5`"}]}], 
             "}"}], ",", "5", ",", 
            RowBox[{"Global`powerDescription", "\[Rule]", "True"}], ",", 
            RowBox[{"Global`gammaFactor", "\[Rule]", "0.4"}], ",", 
            RowBox[{"Global`colorShift", "\[Rule]", "False"}], ",", 
            RowBox[{"Global`displayThickness", "\[Rule]", "0.005`"}], ",", 
            RowBox[{"Global`extensionLength", "\[Rule]", "4."}], ",", 
            RowBox[{"Global`terminatePower", "\[Rule]", "0.001`"}], ",", 
            RowBox[{"Global`verbose", "\[Rule]", "0"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{
             RowBox[{"-", "10"}], "Degree"}], ",", 
            RowBox[{"10", "Degree"}], ",", 
            RowBox[{"2", "Degree"}]}], "}"}]}], "]"}], "//", "Flatten"}]}], 
      ";", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"boundaryPlot", "[", 
         RowBox[{"prism", "[", 
          RowBox[{
           RowBox[{"52", " ", "\[Degree]"}], ",", "5", ",", "1.408`"}], "]"}],
          "]"}], ",", 
        RowBox[{"Graphics", "[", "work", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rayTrace", "[", 
   RowBox[{
    RowBox[{"prism", ":", 
     RowBox[{"PatternSequence", "[", 
      RowBox[{"{", 
       RowBox[{"Repeated", "[", 
        RowBox[{"{", 
         RowBox[{"___", ",", 
          RowBox[{"Global`type", "\[Rule]", "_"}], ",", "___"}], "}"}], "]"}],
        "}"}], "]"}]}], ",", 
    RowBox[{"ray", ":", 
     RowBox[{"PatternSequence", "[", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"Global`type", "\[Rule]", "\"\<ray\>\""}], ",", "___"}], 
       "}"}], "]"}]}], ",", "nestmax_", ",", "opts___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "crossing", ",", "cp", ",", "lineparam", ",", "i", ",", "work", ",", 
      "tt", ",", 
      RowBox[{"mintt", "=", "0"}], ",", "rfrktpos", ",", "raypow", ",", 
      "\[Pi]fraction", ",", "raycol", ",", "gamma", ",", "length", ",", 
      "termpower", ",", "colshift", ",", "powcon", ",", "r\[Pi]fraction", ",",
       "t\[Pi]fraction", ",", "rpower", ",", "tpower", ",", "colF", ",", 
      "raythick", ",", "verboseLevel", ",", 
      RowBox[{"colorIntensityCalib", "=", "1"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"ray", ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"Global`org", "\[Rule]", " ", "_"}], ",", "___"}], 
           "}"}]}], "]"}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"error", "\[Rule]", "\"\<Illigal ray data\>\""}], ",", " ", 
          
          RowBox[{"data", "\[Rule]", " ", "\"\<org\>\""}]}], "}"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"ray", ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"Global`vec", "\[Rule]", " ", "_"}], ",", "___"}], 
           "}"}]}], "]"}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"error", "\[Rule]", "\"\<Illigal ray data\>\""}], ",", " ", 
          
          RowBox[{"data", "\[Rule]", " ", "\"\<vec\>\""}]}], "}"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"ray", ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"Global`pow", "\[Rule]", " ", "_"}], ",", "___"}], 
           "}"}]}], "]"}]}], ",", 
       RowBox[{"raypow", "=", "1"}], ",", 
       RowBox[{"raypow", "=", 
        RowBox[{"Global`pow", "/.", "ray"}]}]}], "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"ray", ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"Global`color", "\[Rule]", " ", "_"}], ",", "___"}], 
           "}"}]}], "]"}]}], ",", 
       RowBox[{"raycol", "=", "0"}], ",", 
       RowBox[{"raycol", "=", 
        RowBox[{"Global`color", "/.", "ray"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"ray", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"Global`\[Pi]powerFraction", "\[Rule]", " ", "_"}], ",", 
           "___"}], "}"}]}], "]"}], ",", 
       RowBox[{"\[Pi]fraction", "=", 
        RowBox[{"(", 
         RowBox[{"Global`\[Pi]powerFraction", "/.", "ray"}], ")"}]}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"ray", ",", 
           RowBox[{"{", 
            RowBox[{"___", ",", 
             RowBox[{"Global`\[Sigma]powerFraction", "\[Rule]", " ", "_"}], 
             ",", "___"}], "}"}]}], "]"}], ",", 
         RowBox[{"\[Pi]fraction", "=", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"Global`\[Sigma]powerFraction", "/.", "ray"}], ")"}]}]}], 
         ",", 
         RowBox[{"\[Pi]fraction", "=", "0.5"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"Global`colorShift", "\[Rule]", "_"}], ",", "___"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"colshift", "=", 
        RowBox[{"Global`colorShift", "/.", 
         RowBox[{"{", "opts", "}"}]}]}], ",", 
       RowBox[{"colshift", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"Global`gammaFactor", "\[Rule]", "_"}], ",", "___"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"gamma", "=", 
        RowBox[{"Global`gammaFactor", "/.", 
         RowBox[{"{", "opts", "}"}]}]}], ",", 
       RowBox[{"gamma", "=", "0.1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"Global`powerDescription", "\[Rule]", "_"}], ",", "___"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"powcon", "=", 
        RowBox[{"Global`powerDescription", "/.", 
         RowBox[{"{", "opts", "}"}]}]}], ",", 
       RowBox[{"powcon", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"Global`extensionLength", "\[Rule]", "_"}], ",", "___"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"length", "=", 
        RowBox[{"Global`extensionLength", "/.", 
         RowBox[{"{", "opts", "}"}]}]}], ",", 
       RowBox[{"length", "=", "10"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"Global`terminatePower", "\[Rule]", "_"}], ",", "___"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"termpower", "=", 
        RowBox[{"Global`terminatePower", "/.", 
         RowBox[{"{", "opts", "}"}]}]}], ",", 
       RowBox[{"termpower", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"Global`displayThickness", "\[Rule]", "_"}], ",", "___"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"raythick", "=", 
        RowBox[{"Global`displayThickness", "/.", 
         RowBox[{"{", "opts", "}"}]}]}], ",", 
       RowBox[{"raythick", "=", "0.01"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"Global`verbose", "\[Rule]", "_"}], ",", "___"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"verboseLevel", "=", 
        RowBox[{"Global`verbose", "/.", 
         RowBox[{"{", "opts", "}"}]}]}], ",", 
       RowBox[{"verboseLevel", "=", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"colshift", " ", "\[NotEqual]", "0"}], "&&", 
        RowBox[{"raypow", "<", "0.01"}]}], ",", 
       RowBox[{
        RowBox[{"raycol", "+=", "colshift"}], ";", 
        RowBox[{"raypow", "=", "1."}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"termpower", "\[NotEqual]", " ", "0"}], "&&", " ", 
          RowBox[{"raypow", "\[LessEqual]", "termpower"}]}], ",", " ", 
         RowBox[{"nestmax", "=", 
          RowBox[{"-", "1"}]}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"colF", "[", "pow_", "]"}], "=", 
      RowBox[{"Sequence", "[", 
       RowBox[{
        RowBox[{"LCHColor", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"powcon", "\[Equal]", "False"}], ",", "1.", ",", 
            RowBox[{"Abs", "[", 
             SuperscriptBox["pow", "gamma"], "]"}]}], "]"}], ",", "raycol"}], 
         "]"}], ",", 
        RowBox[{"Thickness", "[", "raythick", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verboseLevel", "==", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"nestmax", ",", 
         RowBox[{"LCHColor", "[", 
          RowBox[{"1.0", ",", 
           SuperscriptBox["raypow", "gamma"], ",", "raycol"}], "]"}], ",", 
         RowBox[{"\"\<Power=\>\"", "<>", 
          RowBox[{"ToString", "@", "raypow"}]}], ",", 
         RowBox[{"\"\<,\[Pi]fraction=\>\"", "<>", 
          RowBox[{"ToString", "@", "\[Pi]fraction"}]}], ",", 
         RowBox[{"\"\<,Gamma=\>\"", "<>", 
          RowBox[{"ToString", "@", "gamma"}]}], ",", 
         RowBox[{"\"\<,Extension:\>\"", "<>", 
          RowBox[{"ToString", "@", "length"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cp", "[", "idx", "]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"mintt", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "prism", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"crossing", "=", 
             RowBox[{"Switch", "[", 
              RowBox[{
               RowBox[{"Global`type", "/.", 
                RowBox[{
                "prism", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
               "\"\<line\>\"", ",", 
               RowBox[{"crossLine", "[", 
                RowBox[{
                 RowBox[{
                 "prism", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "ray"}], "]"}], ",", 
               "\[IndentingNewLine]", "\"\<arc\>\"", ",", 
               RowBox[{"crossArc", "[", 
                RowBox[{
                 RowBox[{
                 "prism", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "ray"}], "]"}], ",", 
               "\[IndentingNewLine]", "\"\<func\>\"", ",", 
               RowBox[{"crossPoint", "[", 
                RowBox[{
                 RowBox[{
                 "prism", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "ray"}], "]"}], ",", 
               "\[IndentingNewLine]", "\t", "True", ",", 
               RowBox[{"{", 
                RowBox[{"test", "\[Rule]", "aaa"}], "}"}]}], "]"}]}], ")"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"___", ",", 
             RowBox[{"cross", "\[Rule]", "_"}], ",", "___"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"cross", "/.", "crossing"}], ")"}], "\[GreaterEqual]", 
              "1"}], "  ", "&&", " ", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"crossing", ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"pos", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"_", ",", "_"}], "}"}]}], ",", "___"}], "}"}]}], 
              "]"}], "&&", " ", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"crossing", ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"tangent", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"_", ",", "_"}], "}"}]}], ",", "___"}], "}"}]}], 
              "]"}], "&&", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"crossing", ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"rayinfo", "\[Rule]", "__"}], ",", "___"}], "}"}]}], 
              "]"}]}], ")"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tt", "=", 
             RowBox[{"Global`t", "/.", 
              RowBox[{"(", 
               RowBox[{"rayinfo", "/.", "crossing"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verboseLevel", "==", "2"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"idx", "\[Rule]", "i"}], ",", 
                   RowBox[{"raydat", "\[Rule]", "ray"}], ",", 
                   RowBox[{"Global`t", "\[Rule]", "tt"}], ",", 
                   RowBox[{"min", "\[Rule]", "mintt"}]}], "}"}], ",", 
                 "crossing"}], "]"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"tt", ">", "0.001"}], " ", "&&", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"mintt", "\[Equal]", "0"}], "||", 
                  RowBox[{"tt", "<", "mintt"}]}], ")"}]}], ")"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{
               RowBox[{"mintt", "=", "tt"}], ";", 
               RowBox[{
                RowBox[{"cp", "[", "idx", "]"}], "=", "i"}], ";", 
               RowBox[{
                RowBox[{"cp", "[", "res", "]"}], "=", 
                RowBox[{"(", 
                 RowBox[{"rayinfo", "/.", "crossing"}], ")"}]}], ";", 
               RowBox[{
                RowBox[{"cp", "[", "pos", "]"}], "=", 
                RowBox[{"pos", "/.", "crossing"}]}], ";", 
               RowBox[{
                RowBox[{"cp", "[", "norm", "]"}], "=", 
                RowBox[{"(", 
                 RowBox[{"tangent", "/.", "crossing"}], ")"}]}]}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verboseLevel", "==", "2"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<First crossing:\>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cp", "[", "idx", "]"}], ",", 
            RowBox[{"cp", "[", "pos", "]"}], ",", 
            RowBox[{"cp", "[", "norm", "]"}], ",", 
            RowBox[{"cp", "[", "res", "]"}]}], "}"}]}]}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"cp", "[", "idx", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"colF", "[", "raypow", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Global`org", "/.", "ray"}], ",", 
             RowBox[{
              RowBox[{"Global`parametric", "/.", 
               RowBox[{"v2p", "[", "ray", "]"}]}], "/.", 
              RowBox[{"Global`t", "\[Rule]", "  ", "length"}]}]}], "}"}], 
           "]"}]}], "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"lineparam", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Global`org", "/.", "ray"}], ")"}], ",", 
        RowBox[{"cp", "[", "pos", "]"}]}], 
       RowBox[{"(*", " ", 
        RowBox[{"rayorg", "+", 
         RowBox[{"rayvec", " ", 
          RowBox[{"(", 
           RowBox[{"Global`t", "/.", 
            RowBox[{"cp", "[", "res", "]"}]}], ")"}]}]}], "*)"}], "}"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"prism", "\[LeftDoubleBracket]", 
           RowBox[{"cp", "[", "idx", "]"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"trap", "\[Rule]", "True"}], ",", "___"}], "}"}]}], "]"}],
         "||", 
        RowBox[{"nestmax", "\[LessEqual]", " ", "0"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"termpower", ">", "0"}], "&&", 
          RowBox[{"raypow", "<", "termpower"}]}], ")"}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"colF", "[", "raypow", "]"}], ",", 
          RowBox[{"Line", "[", "lineparam", "]"}]}], "}"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rfrktpos", "=", 
      RowBox[{"refract", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"normal", "\[Rule]", 
            RowBox[{"cp", "[", "norm", "]"}]}], "}"}], ",", 
          RowBox[{"prism", "\[LeftDoubleBracket]", 
           RowBox[{"cp", "[", "idx", "]"}], "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "ray"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "refract\:306b\:3088\:308a\:5f97\:3089\:308c\:305f\:53cd\:5c04\:7387\
\:3092\:5143\:306b", "\:3001", 
       RowBox[{
       "\:6b21\:306b\:547c\:3076rayTrace\:306e\:30d1\:30ef", "\:30fc", 
        "\:3068\[Pi]\:504f\:5149\:6bd4\:7387\:3092\:6c42\:3081\:3066\:304a\
\:304f"}], "\:3002"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"powcon", "||", "True"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "pr\[Pi]", ",", "pr\[Sigma]", ",", "pt\[Pi]", ",", "pt\[Sigma]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pr\[Pi]", "=", 
           RowBox[{"raypow", "*", "\[Pi]fraction", "*", 
            RowBox[{"(", 
             RowBox[{"rp", "/.", "rfrktpos"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pr\[Sigma]", "=", 
           RowBox[{"raypow", "*", 
            RowBox[{"(", 
             RowBox[{"1.", "-", "\[Pi]fraction"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"rs", "/.", "rfrktpos"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rpower", "=", 
           RowBox[{"pr\[Pi]", "+", "pr\[Sigma]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"r\[Pi]fraction", "=", 
           RowBox[{"pr\[Pi]", "/", "rpower"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pt\[Pi]", "=", 
           RowBox[{"raypow", "*", "\[Pi]fraction", "*", 
            RowBox[{"(", 
             RowBox[{"1.", "-", 
              RowBox[{"(", 
               RowBox[{"rp", "/.", "rfrktpos"}], ")"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pt\[Sigma]", "=", 
           RowBox[{"raypow", "*", 
            RowBox[{"(", 
             RowBox[{"1.", "-", "\[Pi]fraction"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1.", "-", 
              RowBox[{"(", 
               RowBox[{"rs", "/.", "rfrktpos"}], ")"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tpower", "=", 
           RowBox[{"pt\[Pi]", "+", "pt\[Sigma]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"tpower", "\[Equal]", "0."}], ",", 
            RowBox[{"t\[Pi]fraction", "=", "0.5"}], ",", 
            RowBox[{"t\[Pi]fraction", "=", 
             RowBox[{"pt\[Pi]", "/", "tpower"}]}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{
        RowBox[{"rpower", "=", "raypow"}], ";", 
        RowBox[{"tpower", "=", "raypow"}], ";", 
        RowBox[{"r\[Pi]fraction", "=", "\[Pi]fraction"}], ";", 
        RowBox[{"t\[Pi]fraction", "=", "\[Pi]fraction"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verboseLevel", "==", "3"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Power profile:\>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"{", 
           RowBox[{"raypow", " ", ",", " ", "rpower", ",", "tpower"}], 
           "}"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verboseLevel", "\[Equal]", "5"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"raytrace", "[", 
           RowBox[{"prism", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Global`type", "\[Rule]", "\"\<ray\>\""}], ",", 
              RowBox[{"Global`org", "\[Rule]", 
               RowBox[{"cp", "[", "pos", "]"}]}], ",", 
              RowBox[{"Global`vec", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"vect", "/.", "rfrktpos"}], ")"}]}], ",", 
              RowBox[{
              "Global`\[Pi]powerFraction", "\[Rule]", "t\[Pi]fraction"}], ",", 
              RowBox[{"Global`color", "\[Rule]", "raycol"}], ",", 
              RowBox[{"Global`pow", "\[Rule]", "tpower"}]}], "}"}], ",", 
            RowBox[{"nestmax", "-", "1"}], ",", "opts"}], "]"}], ",", 
          RowBox[{"raytrace", "[", 
           RowBox[{"prism", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Global`type", "\[Rule]", "\"\<ray\>\""}], ",", 
              RowBox[{"Global`org", "\[Rule]", 
               RowBox[{"cp", "[", "pos", "]"}]}], ",", 
              RowBox[{"Global`vec", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"vecr", "/.", "rfrktpos"}], ")"}]}], ",", 
              RowBox[{
              "Global`\[Pi]powerFraction", "\[Rule]", "r\[Pi]fraction"}], ",",
               " ", 
              RowBox[{"Global`color", "\[Rule]", "raycol"}], ",", 
              RowBox[{"Global`pow", "\[Rule]", "rpower"}]}], "}"}], ",", 
            RowBox[{"nestmax", "-", "1"}], ",", "opts"}], "]"}]}], "}"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"status", "/.", "rfrktpos"}], ")"}], ",", 
       "\[IndentingNewLine]", "\"\<Refracted\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"rayTrace", "[", 
           RowBox[{"prism", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Global`type", "\[Rule]", "\"\<ray\>\""}], ",", 
              RowBox[{"Global`org", "\[Rule]", 
               RowBox[{"cp", "[", "pos", "]"}]}], ",", 
              RowBox[{"Global`vec", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"vect", "/.", "rfrktpos"}], ")"}]}], ",", 
              RowBox[{
              "Global`\[Pi]powerFraction", "\[Rule]", "t\[Pi]fraction"}], ",", 
              RowBox[{"Global`color", "\[Rule]", "raycol"}], ",", 
              RowBox[{"Global`pow", "\[Rule]", "tpower"}]}], "}"}], ",", 
            RowBox[{"nestmax", "-", "1"}], ",", "opts"}], "]"}], ",", 
          RowBox[{"rayTrace", "[", 
           RowBox[{"prism", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Global`type", "\[Rule]", "\"\<ray\>\""}], ",", 
              RowBox[{"Global`org", "\[Rule]", 
               RowBox[{"cp", "[", "pos", "]"}]}], ",", 
              RowBox[{"Global`vec", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"vecr", "/.", "rfrktpos"}], ")"}]}], ",", 
              RowBox[{
              "Global`\[Pi]powerFraction", "\[Rule]", "r\[Pi]fraction"}], ",",
               " ", 
              RowBox[{"Global`color", "\[Rule]", "raycol"}], ",", 
              RowBox[{"Global`pow", "\[Rule]", "rpower"}]}], "}"}], ",", 
            RowBox[{"nestmax", "-", "1"}], ",", "opts"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"colF", "[", "raypow", "]"}], ",", 
            RowBox[{"Line", "[", "lineparam", "]"}]}], "}"}]}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", "\"\<Critical Reflection\>\"", ",", 
       RowBox[{"Return", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"rayTrace", "[", 
           RowBox[{"prism", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Global`type", "\[Rule]", "\"\<ray\>\""}], ",", 
              RowBox[{"Global`org", "\[Rule]", 
               RowBox[{"cp", "[", "pos", "]"}]}], ",", 
              RowBox[{"Global`vec", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"vecr", "/.", "rfrktpos"}], ")"}]}], ",", 
              RowBox[{
              "Global`\[Pi]powerFraction", "\[Rule]", "t\[Pi]fraction"}], ",",
               " ", 
              RowBox[{"Global`color", "\[Rule]", "raycol"}], ",", 
              RowBox[{"Global`pow", "\[Rule]", "rpower"}]}], "}"}], ",", 
            RowBox[{"nestmax", "-", "1"}], ",", "opts"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"colF", "[", "raypow", "]"}], ",", 
            RowBox[{"Line", "[", "lineparam", "]"}]}], "}"}]}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", "True", ",", 
       RowBox[{"Return", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"colF", "[", "raypow", "]"}], ",", 
           RowBox[{"Line", "[", "lineparam", "]"}]}], "}"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6862613204406567`*^9, 3.6862616403446198`*^9}, {
   3.686263570165276*^9, 3.686263602854124*^9}, {3.6862640013097305`*^9, 
   3.686264013892846*^9}, 3.686265548929872*^9, {3.6862818603113585`*^9, 
   3.6862819407803793`*^9}, {3.686283518618081*^9, 3.6862835375582123`*^9}, {
   3.6862835745475783`*^9, 3.6862835946686835`*^9}, {3.686283730171112*^9, 
   3.686283755707245*^9}, {3.686283830869734*^9, 3.686283872521728*^9}, {
   3.686283915144442*^9, 3.6862840302404857`*^9}, {3.686284145612488*^9, 
   3.686284151101432*^9}, {3.686284204948983*^9, 3.6862842565397215`*^9}, {
   3.6862842972576127`*^9, 3.6862843109329166`*^9}, {3.686284537443956*^9, 
   3.686284541637825*^9}, {3.6862846040396457`*^9, 3.6862846217077184`*^9}, {
   3.686284750038757*^9, 3.686284804133515*^9}, {3.686285119505087*^9, 
   3.6862851359284477`*^9}, {3.6862852043460903`*^9, 
   3.6862852107564087`*^9}, {3.686285501572261*^9, 3.6862855135086517`*^9}, {
   3.686285694573448*^9, 3.686285719380871*^9}, {3.6862857584066954`*^9, 
   3.6862857713524714`*^9}, 3.686285929054865*^9, {3.6862863138719606`*^9, 
   3.686286315096244*^9}, {3.6862864298792515`*^9, 3.686286458184399*^9}, {
   3.686286688306654*^9, 3.6862867066425037`*^9}, {3.686287641877697*^9, 
   3.686287835968046*^9}, {3.686288340707287*^9, 3.686288404535429*^9}, 
   3.686288560705536*^9, {3.6862886553692226`*^9, 3.686288671430665*^9}, {
   3.733993413159834*^9, 3.7339934393558345`*^9}, {3.7339936318591022`*^9, 
   3.733993658947275*^9}, {3.733993719074193*^9, 3.7339937193788075`*^9}, {
   3.7339937580638676`*^9, 3.733993758427884*^9}, {3.7339945267134457`*^9, 
   3.7339945517862463`*^9}, {3.7339950318744907`*^9, 
   3.7339950324392924`*^9}, {3.7339950998135495`*^9, 3.733995374958169*^9}, {
   3.7339954509209585`*^9, 3.733995486425853*^9}, {3.733995609297413*^9, 
   3.733995645775961*^9}, {3.736036365389204*^9, 3.7360363683863907`*^9}, {
   3.7664596647379503`*^9, 3.7664596994772186`*^9}, {3.7676556325699873`*^9, 
   3.767655682606797*^9}, {3.767655737595891*^9, 3.7676557649564915`*^9}, {
   3.767655825502178*^9, 3.767655845989273*^9}, {3.767656001640099*^9, 
   3.767656005703539*^9}, 3.7676560698375216`*^9, {3.7676561464159737`*^9, 
   3.767656148768198*^9}, 3.767656224091001*^9, {3.767656259948842*^9, 
   3.7676562953867235`*^9}, {3.767656340685559*^9, 3.767656342777791*^9}, {
   3.7676564448759956`*^9, 3.767656451347253*^9}, {3.767656489188967*^9, 
   3.767656497450094*^9}, {3.767656570949696*^9, 3.767656684312566*^9}, {
   3.7676567592969904`*^9, 3.76765678326118*^9}, {3.7676568247025423`*^9, 
   3.767656836470559*^9}, {3.767656927565359*^9, 
   3.7676569291784067`*^9}},ExpressionUUID->"bb60f128-836c-43fc-9fe6-\
c951d367fb4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"boundaryPlot", "[", 
   RowBox[{
    RowBox[{"prism", ":", 
     RowBox[{"PatternSequence", "[", 
      RowBox[{"{", 
       RowBox[{"Repeated", "[", 
        RowBox[{"{", 
         RowBox[{"___", ",", 
          RowBox[{"Global`type", "\[Rule]", "_"}], ",", "___"}], "}"}], "]"}],
        "}"}], "]"}]}], ",", "opts___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ParametricPlot", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"{", 
        RowBox[{"Global`t", ",", "0", ",", "1"}], "}"}], ",", "opts"}], "]"}],
      "&"}], ")"}], "[", 
   RowBox[{"Global`parametric", "/.", "\[VeryThinSpace]", 
    RowBox[{"v2p", "/@", "prism"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.686287855860504*^9, 3.6862878963719997`*^9}, {
   3.733993533362999*^9, 3.7339936054197187`*^9}, {3.733993649996297*^9, 
   3.733993650546999*^9}, 3.767655683767627*^9, 3.767656159874878*^9, 
   3.7676568420057716`*^9},ExpressionUUID->"a8d5b26e-98d7-4463-aecc-\
41a4eaee789c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"refract", "[", 
    RowBox[{
     RowBox[{"bd", ":", 
      RowBox[{"PatternSequence", "[", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"normal", "\[Rule]", "__"}], ",", "___"}], "}"}], "]"}]}], 
     ",", 
     RowBox[{"ray", ":", 
      RowBox[{"PatternSequence", "[", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"Global`type", "\[Rule]", "\"\<ray\>\""}], ",", "___"}], 
        "}"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dx", ",", "dy", ",", "rx", ",", "ry", ",", "scl", ",", "c1", ",", "c2",
        ",", "n1", ",", "n2", ",", "nn", ",", "work", ",", "vecR", ",", " ", 
       "vecT", ",", "\[Theta]in", ",", "\[Theta]out", ",", "refMat", ",", 
       "absMat", ",", "rpW", ",", "rsW"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"bd", ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"normal", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_"}], "}"}]}], ",", "___"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"work", "=", 
          RowBox[{"(", 
           RowBox[{"normal", "/.", "bd"}], ")"}]}], ";", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dx", ",", "dy"}], "}"}], "=", 
           RowBox[{"Normalize", "@", "work"}]}], "]"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"error", "\[Rule]", "\"\<Illigal border data\>\""}], ",", 
           RowBox[{"Global`function", "\[Rule]", "\"\<refract\>\""}], ",", 
           RowBox[{"arg", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"bd", ",", "ray"}], "}"}]}]}], "}"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"bd", ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"Global`ri", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_"}], "}"}]}], ",", "___"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"work", "=", 
          RowBox[{"(", 
           RowBox[{"Global`ri", "/.", "bd"}], ")"}]}], ";", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n2", ",", "n1"}], "}"}], "=", "work"}], "]"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"error", "\[Rule]", "\"\<Illigal border data\>\""}], ",", 
           RowBox[{"Global`function", "\[Rule]", "\"\<refract\>\""}], ",", 
           RowBox[{"arg", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"bd", ",", "ray"}], "}"}]}]}], "}"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"bd", ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"Global`reflectivity", "\[Rule]", "_"}], ",", "___"}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"refMat", "=", 
         RowBox[{"(", 
          RowBox[{"Global`reflectivity", "/.", "bd"}], ")"}]}], ",", 
        RowBox[{"refMat", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"bd", ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"Global`absorbance", "\[Rule]", "_"}], ",", "___"}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"absMat", "=", 
         RowBox[{"(", 
          RowBox[{"Global`absorbance", "/.", "bd"}], ")"}]}], ",", 
        RowBox[{"absMat", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"ray", ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"Global`vec", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_"}], "}"}]}], ",", "___"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"work", "=", 
          RowBox[{"(", 
           RowBox[{"Global`vec", "/.", "ray"}], ")"}]}], ";", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rx", ",", "ry"}], "}"}], "=", 
           RowBox[{"Normalize", "@", "work"}]}], "]"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"error", "\[Rule]", "\"\<Illigal ray data\>\""}], ",", 
           RowBox[{"Global`function", "\[Rule]", "\"\<refract\>\""}], ",", 
           RowBox[{"arg", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"bd", ",", "ray"}], "}"}]}]}], "}"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"scl", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rx", ",", "ry"}], "}"}], ".", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}]}], "]"}], "\[LessEqual]", 
         "0.00001"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"status", "\[Rule]", "\"\<Parallel\>\""}], ",", " ", 
           RowBox[{"vecr", "\[Rule]", 
            RowBox[{"{", "}"}]}]}], "}"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"scl", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{
         RowBox[{"dx", "=", 
          RowBox[{"-", "dx"}]}], ";", 
         RowBox[{"dy", "=", 
          RowBox[{"-", "dy"}]}], ";", 
         RowBox[{"nn", "=", "n1"}], ";", 
         RowBox[{"n1", "=", "n2"}], ";", 
         RowBox[{"n2", "=", "nn"}], ";", 
         RowBox[{"scl", "=", 
          RowBox[{"-", "scl"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]in", "=", 
       RowBox[{"Cos", "[", "scl", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dy", " ", "rx"}], " ", "-", " ", 
         RowBox[{"ry", " ", "dx"}]}], " ", ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vecR", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rx", "-", 
          RowBox[{"2", " ", "dx", " ", "scl"}]}], ",", 
         RowBox[{"ry", "-", 
          RowBox[{"2", " ", "dy", " ", "scl"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "(*", "\:81e8\:754c\:53cd\:5c04\:6761\:4ef6\:306e\:6642\:306f\:5883\
\:754c\:9762\:3067\:306e", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c2", "=", 
           RowBox[{
            SuperscriptBox["n1", "2"], "-", 
            RowBox[{
             SuperscriptBox["n2", "2"], " ", 
             SuperscriptBox["c1", "2"]}]}]}], ")"}], "\[LessEqual]", "0"}], 
        ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"status", "\[Rule]", "\"\<Critical Reflection\>\""}], ",", 
           
           RowBox[{"vecr", "\[Rule]", "vecR"}], ",", 
           RowBox[{"angin", "\[Rule]", "\[Theta]in"}], ",", 
           RowBox[{"vect", "\[Rule]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"rp", "\[Rule]", "1"}], ",", 
           RowBox[{"rs", "\[Rule]", "1"}]}], "}"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"\[Theta]out", "=", 
       RowBox[{"ArcSin", "[", 
        RowBox[{
         FractionBox["n2", "n1"], 
         RowBox[{"Sin", "[", "\[Theta]in", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rpW", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumberQ", "[", "refMat", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "absMat"}], ")"}], "refMat"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"refMat", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pi", "\[Rule]", 
                RowBox[{"PatternSequence", "[", 
                 RowBox[{"_Real", "|", "_Integer", "|", "_Rational"}], 
                 "]"}]}], ",", 
               RowBox[{"sigma", "\[Rule]", 
                RowBox[{"PatternSequence", "[", 
                 RowBox[{"_Real", "|", "_Integer", "|", "_Rational"}], 
                 "]"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "absMat"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"pi", "/.", "refMat"}], ")"}]}], " ", ",", 
           RowBox[{
            RowBox[{"Abs", "[", 
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox[
                RowBox[{" ", 
                 RowBox[{"Tan", "[", 
                  RowBox[{"\[Theta]out", "-", "\[Theta]in"}], "]"}]}], 
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Theta]out", "+", "\[Theta]in"}], "]"}]], ")"}], 
              "2"], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "absMat"}], ")"}]}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rsW", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumberQ", "[", "refMat", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "absMat"}], ")"}], "refMat"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"refMat", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pi", "\[Rule]", 
                RowBox[{"PatternSequence", "[", 
                 RowBox[{"_Real", "|", "_Integer", "|", "_Rational"}], 
                 "]"}]}], ",", 
               RowBox[{"sigma", "\[Rule]", 
                RowBox[{"PatternSequence", "[", 
                 RowBox[{"_Real", "|", "_Integer", "|", "_Rational"}], 
                 "]"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "absMat"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"sigma", "/.", "refMat"}], ")"}]}], " ", ",", 
           RowBox[{
            RowBox[{"Abs", "[", 
             SuperscriptBox[
              RowBox[{"(", " ", 
               FractionBox[
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]out", "-", "\[Theta]in"}], "]"}], 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]out", "+", "\[Theta]in"}], "]"}]], ")"}], 
              "2"], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "absMat"}], ")"}]}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"status", "\[Rule]", "\"\<Refracted\>\""}], ",", 
        RowBox[{"vect", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SqrtBox["c2"]}], " ", "dx"}], "+", 
             RowBox[{"dy", " ", "n2", " ", "c1"}]}], "n1"], ",", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{
               SqrtBox["c2"], " ", "dy"}], "+", 
              RowBox[{"n2", "  ", "dx", " ", "c1"}]}], "n1"]}]}], "}"}]}], 
        ",", 
        RowBox[{"vecr", "\[Rule]", "vecR"}], ",", 
        RowBox[{"angin", "\[Rule]", "\[Theta]in"}], ",", 
        RowBox[{"angout", "\[Rule]", "\[Theta]out"}], ",", 
        RowBox[{"rp", "\[Rule]", "rpW"}], ",", 
        RowBox[{"rs", "\[Rule]", "rsW"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "d\:3092\:53cd\:5c04\:754c\:9762\:306e\:6cd5\:7dda\:3068\:898b\:306a\:3057\
\:3066", "\:3001", 
    "\:76f4\:7dda\:3092\:793a\:3059\:5a92\:4ecb\:5909\:6570\:8868\:73fe\:3092\
\:5f97\:308b"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v2f", "[", 
    RowBox[{
     RowBox[{"d", ":", 
      RowBox[{"PatternSequence", "[", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "}"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     RowBox[{"(", 
      RowBox[{"y", "-", 
       RowBox[{"d", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      " ", ")"}]}], "-", 
    RowBox[{
     RowBox[{"d", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
     RowBox[{"(", 
      RowBox[{"x", "-", 
       RowBox[{"d", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      " ", ")"}]}]}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\:30d9\:30af\:30c8\:30eb\:8868\:73fe", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "\:306b\:5bfe\:3057\:3066"}], "\:3001", 
    "d\:3092\:63a5\:7dda\:3068\:3059\:308b\:3088\:3046\:306a\:76f4\:7dda\:306e\
\:65b9\:7a0b\:5f0f\:3092\:8868\:73fe\:3059\:308b"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v2p", "[", 
    RowBox[{"d", ":", 
     RowBox[{"PatternSequence", "[", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"Global`type", "\[Rule]", "_"}], ",", "___"}], "}"}], "]"}]}],
     "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Global`parametric", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Global`org", "+", 
             RowBox[{"Global`vec", " ", "Global`t"}]}], "/.", "d"}], ")"}]}], 
         "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Global`type", "/.", "d"}], ")"}], "\[Equal]", 
          "\"\<ray\>\""}], "||", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Global`type", "/.", "d"}], ")"}], "\[Equal]", 
          "\"\<line\>\""}], " ", "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Global`type", "/.", "d"}], ")"}], "\[Equal]", 
            "\"\<arc\>\""}], "&&", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Global`cuv", "/.", "d"}], ")"}], "==", "0"}]}], 
          ")"}]}]}], "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "xc", ",", "yc", ",", "arg1", ",", "arg2", ",", "start\[Phi]", ",",
             "end\[Phi]", ",", "r", ",", "ri", ",", "work"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"work", "=", 
                 RowBox[{"v2\[Theta]c", "[", "d", "]"}]}], ")"}], ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"center", "\[Rule]", "_"}], ",", "___"}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "xc", ",", "yc", ",", "start\[Phi]", ",", "end\[Phi]", ",", 
                 "r"}], "}"}], "=", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{"center", ",", 
                   RowBox[{"{", 
                    RowBox[{"start", ",", "end", ",", 
                    RowBox[{"1.", "/", "invradius"}]}], "}"}]}], "]"}], "/.", 
                 "work"}], ")"}]}], "]"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"error", "\[Rule]", "\"\<Center cannot got.\>\""}], 
                ",", 
                RowBox[{"Global`function", "\[Rule]", "\"\<v2p\>\""}], ",", 
                RowBox[{"arc", "\[Rule]", "d"}]}], "}"}], "]"}]}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"r", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"1", "<", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["Global`cuv", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{
                    "Global`vec", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{
                    "Global`vec", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "2"]}], ")"}]}], "/.", "d"}], 
                  ")"}]}], ",", 
                RowBox[{"Norm", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"xc", ",", "yc"}], "}"}], "-", 
                  RowBox[{"(", 
                   RowBox[{"Global`org", "/.", "d"}], ")"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"1", "/", "Global`cuv"}], "/.", "d"}]}], "]"}]}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Global`parametric", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xc", "+", 
                RowBox[{"r", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"start\[Phi]", "+", 
                   RowBox[{"Global`t", " ", 
                    RowBox[{"(", 
                    RowBox[{"end\[Phi]", "-", "start\[Phi]"}], ")"}]}]}], 
                  "]"}]}]}], ",", 
               RowBox[{"yc", "+", " ", 
                RowBox[{"r", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"start\[Phi]", "+", 
                   RowBox[{"Global`t", " ", 
                    RowBox[{"(", 
                    RowBox[{"end\[Phi]", "-", "start\[Phi]"}], ")"}]}]}], 
                  "]"}]}]}]}], "}"}]}], "}"}]}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Global`type", "/.", "d"}], ")"}], "\[Equal]", 
         "\"\<arc\>\""}]}], "}"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Global`parametric", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"Global`parametric", "/.", "d"}], ")"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Global`type", "/.", "d"}], ")"}], "\[Equal]", 
         "\"\<func\>\""}]}], " ", "}"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "True"}], "}"}]}], "\[IndentingNewLine]", 
     "}"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"d\:3092\:5149\:7dda", 
     RowBox[{"{", "\:ff14\:8981\:7d20\:30ea\:30b9\:30c8", "}"}], 
     "\:3068\:898b\:306a\:3057\:3066"}], "\:3001", 
    "\:76f4\:7dda\:3092\:793a\:3059\:5a92\:4ecb\:5909\:6570\:8868\:73fe\:3092\
\:5f97\:308b"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"v\:3092\:5186\:5f27\:7dda", 
     RowBox[{"{", 
      RowBox[{
      "\:59cb\:70b9x", ",", " ", "\:59cb\:70b9y", ",", " ", 
       "x\:7d42\:70b9\:8ddd\:96e2", "\:3001", " ", 
       "y\:7d42\:70b9\:8ddd\:96e2", ",", " ", 
       "\:534a\:5f84\:306e\:9006\:6570"}], "}"}], 
     "\:3068\:898b\:306a\:3057\:3066"}], "\:3001", 
    "\:5186\:5f27\:3092\:793a\:3059\:5a92\:4ecb\:5909\:6570\:8868\:73fe\:3092\
\:5f97\:308b"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v2\[Theta]c", "::", "usage"}], "=", 
    "\"\<Arc\:30c7\:30fc\:30bf\:304b\:3089\:3001\:4e2d\:5fc3\:3092\:6c42\:3081\
\:308b\:3002\:4ef0\:89d2\:306e\:30da\:30a2\:3092\:6c42\:3081\:308b\:3002\n\
\:7b2c5\:8981\:7d20(cuv)\:306f\:534a\:5f84\:306e\:9006\:6570\:3067\:3001\:6b63\
\:3067\:3042\:308c\:3070\:4e2d\:5fc3\:306f\:59cb\:70b9\:304b\:3089\:7d42\:70b9\
\:3092\:898b\:305f\:3068\:304d\:53f3\:306b\:3001\:8ca0\:306e\:6642\:306f\:5de6\
\:306b\:3042\:308b\:3002\n\:7b2c6,7\:8981\:7d20(ri)\:306f\:5c48\:6298\:7387\
\:3067\:3001\:59cb\:70b9\:304b\:3089\:7d42\:70b9\:3092\:898b\:305f\:3068\:304d\
\:306b\:7b2c6\:8981\:7d20\:304c\:53f3\:5074\:3001\:3060\:3044\:ff17\:8981\
\:7d20\:304c\:5de6\:5074\:306e\:5c48\:6298\:7387\:3002\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"v\:3092\:5186\:5f27\:7dda", 
     RowBox[{"{", 
      RowBox[{
      "\:59cb\:70b9x", ",", " ", "\:59cb\:70b9y", ",", " ", 
       "x\:7d42\:70b9\:8ddd\:96e2", "\:3001", " ", 
       "y\:7d42\:70b9\:8ddd\:96e2", ",", " ", 
       RowBox[{
       "\:59cb\:70b9\:3068\:7d42\:70b9\:306e\:5411\:304d\:306e\:5909\:5316\
\:89d2", "/", "\:5186\:5f27\:9577"}]}], "}"}], 
     "\:3068\:898b\:306a\:3057\:3066"}], "\:3001", 
    "\:5186\:5f27\:4e2d\:5fc3\:3092\:4e0e\:3048\:308b"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2\[Theta]c", "[", 
   RowBox[{"d", ":", 
    RowBox[{"PatternSequence", "[", 
     RowBox[{"{", 
      RowBox[{"___", ",", 
       RowBox[{"Global`type", "\[Rule]", "_"}], ",", "___"}], "}"}], "]"}]}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xc", ",", "yc", ",", "dx", ",", "dy", ",", "x0", ",", "y0", ",", "rinv",
       ",", "r", ",", "ri", ",", "arg1", ",", "arg2", ",", "arg3", ",", 
      "\[Phi]", ",", "work"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Global`type", "/.", "d"}], ")"}], "\[NotEqual]", 
         "\"\<arc\>\""}], "||", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Global`cuv", "/.", "d"}], ")"}], "\[Equal]", "0"}]}], ",", 
       
       RowBox[{"Return", "[", 
        RowBox[{"{", " ", 
         RowBox[{"error", "\[Rule]", "\"\<no center\>\""}], "}"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dx", ",", "dy"}], "}"}], "=", 
       RowBox[{"(", 
        RowBox[{"Global`vec", "/.", "d"}], ")"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x0", ",", "y0"}], "}"}], "=", 
       RowBox[{"(", 
        RowBox[{"Global`org", "/.", "d"}], ")"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rinv", "=", 
      RowBox[{"Global`cuv", "/.", "d"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"work", "=", 
            RowBox[{"v2c", "[", "d", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"___", ",", 
             RowBox[{"error", "\[Rule]", "_"}], ",", "___"}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"error", "\[Rule]", "\"\<Illigal Data\>\""}], ",", " ", 
            RowBox[{"Global`function", "\[Rule]", " ", "v2c"}], ",", " ", 
            RowBox[{"arg", "\[Rule]", "d"}]}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xc", ",", "yc"}], "}"}], "=", 
          RowBox[{"center", "/.", "work"}]}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["dx", "2"], "+", 
        SuperscriptBox["dy", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"work", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["rinv", "2"], 
         SuperscriptBox["r", "2"]}], "4"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xc", ",", "yc"}], "}"}], "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"work", ">", "0"}], ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x0", "+", 
             FractionBox["dx", "2"], "+", 
             RowBox[{
              FractionBox["dy", "r"], 
              FractionBox["1", "rinv"], " ", 
              SqrtBox["work"]}]}], ")"}], ",", 
           RowBox[{"y0", "+", 
            FractionBox["dy", "2"], "-", 
            RowBox[{
             FractionBox[
              RowBox[{"dx", " "}], "r"], 
             FractionBox["1", "rinv"], 
             SqrtBox["work"]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x0", "+", 
             FractionBox["dx", "2"], "-", 
             RowBox[{
              FractionBox["dy", "r"], 
              FractionBox["1", "rinv"], " ", 
              SqrtBox[
               SuperscriptBox["work", "2"]]}]}], ")"}], ",", 
           RowBox[{"y0", "+", 
            FractionBox["dy", "2"], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"dx", " "}], "r"], 
             FractionBox["1", "rinv"], 
             SqrtBox[
              SuperscriptBox["work", "2"]]}]}]}], "}"}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ri", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["rinv", "2"], 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["dx", "2"], "+", 
              SuperscriptBox["dy", "2"]}], ")"}]}], "/.", "d"}], ")"}]}], ",", 
        RowBox[{"1", "/", 
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xc", ",", "yc"}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "y0"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"Abs", "[", "rinv", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"arg1", "=", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"x0", "-", "xc"}], ",", 
        RowBox[{"y0", "-", "yc"}]}], "]"}]}], ";", 
     RowBox[{"arg2", "=", 
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{"x0", "+", "dx", "-", "xc"}], ",", 
         RowBox[{"y0", "+", "dy", "-", "yc"}]}], "]"}], "/.", "d"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rinv", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
        RowBox[{"arg1", "<", "arg2"}]}], ",", 
       RowBox[{"arg1", "+=", 
        RowBox[{"2", " ", "\[Pi]"}]}]}], "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rinv", "<", "0"}], " ", "&&", " ", 
        RowBox[{"arg1", ">", "arg2"}]}], ",", 
       RowBox[{"arg2", "+=", 
        RowBox[{"2", " ", "\[Pi]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"start", "\[Rule]", " ", "arg1"}], ",", 
        RowBox[{"end", "\[Rule]", " ", "arg2"}], ",", 
        RowBox[{"center", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"xc", ",", "yc"}], "}"}]}], ",", 
        RowBox[{"invradius", "\[Rule]", "ri"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"crossLine", "[", 
    RowBox[{
     RowBox[{"aa", ":", 
      RowBox[{"PatternSequence", "[", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"Global`type", "\[Rule]", "_"}], ",", "___"}], "}"}], 
       "]"}]}], ",", 
     RowBox[{"bb", ":", 
      RowBox[{"PatternSequence", "[", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"Global`type", "\[Rule]", "_"}], ",", "___"}], "}"}], 
       "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w1", ",", "w2", ",", "a", ",", "b", ",", "c"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"crossline2", "[", 
         RowBox[{"a", ",", "b"}], "]"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Global`type", "/.", "aa"}], ")"}], "\[NotEqual]", 
            "\"\<line\>\""}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Global`type", "/.", "aa"}], ")"}], "\[NotEqual]", 
            "\"\<ray\>\""}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Global`type", "/.", "bb"}], ")"}], "\[NotEqual]", 
            "\"\<line\>\""}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Global`type", "/.", "bb"}], ")"}], "\[NotEqual]", 
            "\"\<ray\>\""}]}], ")"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"error", "\[Rule]", "\"\<Illigal Data\>\""}], ",", " ", 
           RowBox[{"Global`function", "\[Rule]", "\"\<crossLine\>\""}]}], 
          "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Join", "[", 
          RowBox[{"Global`org", ",", "Global`vec"}], "]"}], ")"}], "/.", 
        "aa"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["b",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Join", "[", 
          RowBox[{"Global`org", ",", "Global`vec"}], "]"}], ")"}], "/.", 
        "bb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
           " ", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "==", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           " ", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], 
        ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cross", "\[Rule]", "0"}], ",", " ", 
           RowBox[{"status", "\[Rule]", "\"\<Parallel Objects\>\""}]}], "}"}],
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"w1", "=", "  ", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "b", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "-", 
            
            RowBox[{
            "a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           ")"}], 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            
            RowBox[{
            "b", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ")"}], " ", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
           " ", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "-", 
         
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           " ", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}]]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"w2", "=", " ", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "b", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "-", 
            
            RowBox[{
            "a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           ")"}], 
          RowBox[{
          "a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
            "-", 
            RowBox[{
            "b", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ")"}], 
          RowBox[{"a", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
           " "}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
           " ", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "-", 
         
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           " ", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}]]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"w1", "<", "0"}], " ", "||", " ", 
         RowBox[{"w1", ">", "1"}], "||", 
         RowBox[{"w2", "<", "0"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cross", "\[Rule]", "0"}], ",", " ", 
           RowBox[{"status", "\[Rule]", "\"\<Output Line Range\>\""}]}], 
          "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cross", "\[Rule]", "1"}], ",", " ", 
        RowBox[{"pos", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{"w1", " ", 
             RowBox[{
             "a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
           ",", 
           RowBox[{
            RowBox[{
            "a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{"w1", " ", 
             RowBox[{
             "a", "\[LeftDoubleBracket]", "4", 
              "\[RightDoubleBracket]"}]}]}]}], "}"}]}], ",", 
        RowBox[{"tangent", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "a", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", 
            RowBox[{
            "a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
          "}"}]}], ",", 
        RowBox[{"rayinfo", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Global`parametric", "\[Rule]", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
               "b", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{"Global`t", " ", 
                RowBox[{
                "b", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], ",", 
              RowBox[{
               RowBox[{
               "b", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{"Global`t", " ", 
                RowBox[{
                "b", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}]}], "}"}]}], ",", 
           RowBox[{"Global`t", "\[Rule]", " ", "w2"}]}], "}"}]}], ",", 
        RowBox[{"objinfo", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Global`parametric", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
               "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{"Global`t", " ", 
                RowBox[{
                "a", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], ",", 
              RowBox[{
               RowBox[{
               "a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{"Global`t", " ", 
                RowBox[{
                "a", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}]}], "}"}]}], " ", ",", 
           RowBox[{"Global`t", "\[Rule]", "w1"}]}], "}"}]}]}], "}"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"crossArc", "[", 
    RowBox[{
     RowBox[{"arc", ":", 
      RowBox[{"PatternSequence", "[", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"Global`type", "\[Rule]", "\"\<arc\>\""}], ",", "___"}], 
        "}"}], "]"}]}], ",", 
     RowBox[{"ray", ":", 
      RowBox[{"PatternSequence", "[", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"Global`type", "\[Rule]", "\"\<ray\>\""}], ",", "___"}], 
        "}"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x0", ",", "y0", ",", "xd", ",", "yd", ",", "rinv", ",", "e1", ",", 
       "e2", ",", "e3", ",", "e4", ",", "R0", ",", "w1", ",", "w2", ",", "Rx",
        ",", "Ry", ",", "\[Theta]", ",", "\[Eta]", ",", "\[Eta]\[Eta]", ",", 
       "R\[Theta]1", ",", "R\[Theta]2", ",", "\[Phi]\[Phi]", ",", "\[Phi]1", 
       ",", "\[Phi]2", ",", "s", ",", "work", ",", "work2", ",", "temp", ",", 
       "radius"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"crossarc", "[", 
         RowBox[{"arc", ",", "ray"}], "]"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"arc", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"Global`org", "\[Rule]", "_"}], ",", "___"}], "}"}]}], 
            "]"}], "&&", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"arc", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"Global`vec", "\[Rule]", "_"}], ",", "___"}], "}"}]}], 
            "]"}]}], ")"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"error", "\[Rule]", "\"\<Illigal Arc Data\>\""}], ",", 
           RowBox[{"Global`function", "\[Rule]", "\"\<crossArc\>\""}], ",", 
           " ", 
           RowBox[{"arg", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"arc", ",", "ray"}], "}"}]}]}], "}"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"ray", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"Global`org", "\[Rule]", "_"}], ",", "___"}], "}"}]}], 
            "]"}], "&&", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"ray", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"Global`vec", "\[Rule]", "_"}], ",", "___"}], "}"}]}], 
            "]"}]}], ")"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"error", "\[Rule]", "\"\<Illigal Ray Data\>\""}], ",", 
           RowBox[{"Global`function", "\[Rule]", "\"\<crossArc\>\""}], ",", 
           " ", 
           RowBox[{"arg", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"arc", ",", "ray"}], "}"}]}]}], "}"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x0", ",", "y0"}], "}"}], "=", 
        RowBox[{"(", 
         RowBox[{"Global`org", "/.", "arc"}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xd", ",", "yd"}], "}"}], "=", 
        RowBox[{"(", 
         RowBox[{"Global`vec", "/.", "arc"}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rinv", "=", 
       RowBox[{"Global`cuv", "/.", "arc"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"e1", ",", "e2"}], "}"}], "=", 
        RowBox[{"(", 
         RowBox[{"Global`org", "/.", "ray"}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"e3", ",", "e4"}], "}"}], "=", 
        RowBox[{"(", 
         RowBox[{"Global`vec", "/.", "ray"}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{
          "x0", ",", "y0", ",", "xd", ",", "yd", ",", "rinv", ",", "e1", ",", 
           "e2", ",", "e3", ",", "e4"}], "}"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"e3", "\[Equal]", "0"}], "&&", 
         RowBox[{"e4", "\[Equal]", "0"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"error", "\[Rule]", " ", "\"\<Illigal Ray Vector\>\""}], 
           ",", 
           RowBox[{"Global`function", "\[Rule]", "\"\<crossArc\>\""}], ",", 
           " ", 
           RowBox[{"arg", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"arc", ",", "ray"}], "}"}]}]}], "}"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"rinv", "\[Equal]", "0"}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"crossLine", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Global`type", "\[Rule]", "\"\<line\>\""}], ",", 
             RowBox[{"Global`org", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"x0", ",", "y0"}], "}"}]}], ",", 
             RowBox[{"Global`vec", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"xd", ",", "yd"}], "}"}]}]}], "}"}], ",", "ray"}], 
          "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"work", "=", 
           RowBox[{"v2\[Theta]c", "[", "arc", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", 
            RowBox[{"error", "\[Rule]", "_"}], ",", "___"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"error", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"error", "/.", "work"}], ")"}]}], ",", 
           RowBox[{"Global`function", "\[Rule]", "\"\<v2\[Theta]c\>\""}], ",", 
           RowBox[{"arg", "\[Rule]", "arc"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rx", ",", "Ry"}], "}"}], "=", 
           RowBox[{"(", 
            RowBox[{"center", "/.", "work"}], ")"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"R\[Theta]1", ",", "R\[Theta]2"}], "}"}], "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"start", ",", "end"}], "}"}], "/.", "work"}], ")"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"R0", "=", 
          RowBox[{"invradius", "/.", "work"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"\:4ee5\:4e0b\:306f", "\:3001", 
        RowBox[{
         RowBox[{
          RowBox[{"\:5149\:7dda\:306e", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"X", "-", "e1"}], ")"}], "e3"]}], "-", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"Y", "-", "e2"}], ")"}], "e4"]}], "\[Equal]", 
         RowBox[{
         "0", "\:306b\:5186\:5f27\:306e\:5a92\:4ecb\:5909\:6570\:8868\:73fe", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{"X", "\[Rule]", " ", 
             RowBox[{"Rx", "+", 
              RowBox[{
               FractionBox["1", "R0"], " ", 
               RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], ",", 
            RowBox[{"Y", "\[Rule]", " ", 
             RowBox[{"Ry", " ", "+", " ", 
              RowBox[{
               FractionBox["1", "R0"], " ", 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}]}], "}"}], 
          
          "\:3092\:4ee3\:5165\:3057\:3066\:89e3\:304f\:3053\:3068\:3067\:5f97\
\:3089\:308c\:305f"}]}], "\:3002", "\[IndentingNewLine]", "  ", 
        "\:5e7e\:4f55\:5b66\:7684\:306b\:7406\:89e3\:3059\:308b\:306e\:306f\
\:96e3\:3057\:3044\:306e\:3067\:6ce8\:610f", "\:3002"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"w1", "=", " ", 
       RowBox[{
        RowBox[{"e3", " ", 
         RowBox[{"(", 
          RowBox[{"Ry", "-", "e2"}], ")"}]}], "-", 
        RowBox[{"e4", " ", 
         RowBox[{"(", 
          RowBox[{"Rx", "-", "e1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"w2", "=", 
       RowBox[{
        SuperscriptBox["e3", "2"], "+", 
        SuperscriptBox["e4", "2"], "-", 
        RowBox[{
         SuperscriptBox["w1", "2"], " ", 
         SuperscriptBox["R0", "2"]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"w2", "<", "0"}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cross", "\[Rule]", "0"}], ",", " ", 
           RowBox[{
           "status", "\[Rule]", " ", "\"\<No Cross Point with Circle\>\""}]}],
           "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Phi]1", "=", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"w1", " ", "e4", " ", "R0"}], "-", 
          RowBox[{
           SqrtBox["w2"], " ", 
           RowBox[{"Abs", "[", "e3", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "w1"}], " ", "e3", " ", "R0"}], "-", 
          RowBox[{
           RowBox[{"Sign", "[", "e3", "]"}], "e4", " ", 
           SqrtBox["w2"]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Phi]2", "=", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"w1", " ", "e4", " ", "R0"}], "+", 
          RowBox[{
           SqrtBox["w2"], 
           RowBox[{"Abs", "[", "e3", "]"}]}]}], " ", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "w1"}], " ", "e3", " ", "R0"}], "+", 
          RowBox[{
           RowBox[{"Sign", "[", "e3", "]"}], "e4", " ", 
           SqrtBox["w2"]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"\[Phi]1", ",", 
        RowBox[{"\[Phi]2\:306f\:5f27\:4e0a\:306e\:4ea4\:70b9", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Rx", "+", 
            FractionBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "rinv"]}], ",", 
           RowBox[{"Ry", "+", 
            FractionBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "rinv"]}]}], "}"}], 
         "\:306e\:4f4d\:76f8\:89d2\:306e\:5019\:88dc\:3067\:5fc5\:305a\:4e8c\
\:3064"}], "\:3002", "\:59cb\:70b9\:7d42\:70b9\:306e\:95a2\:4fc2\:3067", 
        "\:3001", 
        RowBox[{
        "R\[Theta]1", "-", 
         "R\[Theta]2\:306e\:7bc4\:56f2\:306b\:53ce\:307e\:308b\:3088\:3046\
\:306b\:8abf\:6574"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Phi]1", "<", "R\[Theta]1"}], "&&", 
         RowBox[{"\[Phi]1", "<", "R\[Theta]2"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Phi]1", "+", 
             RowBox[{"2", "\[Pi]"}], "-", "R\[Theta]1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Phi]1", "+", 
             RowBox[{"2", "\[Pi]"}], "-", "R\[Theta]2"}], ")"}]}], "<=", 
          "0"}]}], ",", 
        RowBox[{"\[Phi]1", "=", 
         RowBox[{"\[Phi]1", "+", 
          RowBox[{"2", "\[Pi]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Phi]2", "<", "R\[Theta]1"}], "&&", 
         RowBox[{"\[Phi]2", "<", "R\[Theta]2"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Phi]2", "+", 
             RowBox[{"2", "\[Pi]"}], "-", "R\[Theta]1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Phi]2", "+", 
             RowBox[{"2", "\[Pi]"}], "-", "R\[Theta]2"}], ")"}]}], "<=", 
          "0"}]}], ",", 
        RowBox[{"\[Phi]2", "=", 
         RowBox[{"\[Phi]2", "+", 
          RowBox[{"2", "\[Pi]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Phi]\[Phi]", "=", 
       TagBox[GridBox[{
          {"\[Piecewise]", GridBox[{
             {
              RowBox[{"{", 
               RowBox[{"\[Phi]1", ",", "\[Phi]2"}], "}"}], 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Phi]1", "-", "R\[Theta]1"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"\[Phi]1", "-", "R\[Theta]2"}], ")"}]}], 
                "\[LessEqual]", "0"}], "&&", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Phi]2", "-", "R\[Theta]1"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"\[Phi]2", "-", "R\[Theta]2"}], ")"}]}], 
                "\[LessEqual]", " ", "0"}]}]},
             {
              RowBox[{"{", "\[Phi]1", "}"}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Phi]1", "-", "R\[Theta]1"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"\[Phi]1", "-", "R\[Theta]2"}], ")"}]}], 
               "\[LessEqual]", "0"}]},
             {
              RowBox[{"{", "\[Phi]2", "}"}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Phi]2", "-", "R\[Theta]1"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"\[Phi]2", "-", "R\[Theta]2"}], ")"}]}], 
               "\[LessEqual]", "0"}]},
             {
              RowBox[{"{", "}"}], "True"}
            },
            AllowedDimensions->{2, Automatic},
            Editable->True,
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{1.}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}},
            Selectable->True]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.35]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        "Piecewise",
        DeleteWithContents->True,
        Editable->False,
        SelectWithContents->True,
        Selectable->False]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"\[Piecewise]", GridBox[{
          {
           FractionBox[
            RowBox[{"Rx", "+", 
             FractionBox[
              RowBox[{"Cos", "[", "\[Phi]\[Phi]", "]"}], "R0"], "-", "e1"}], 
            "e3"], 
           RowBox[{"e3", "\[NotEqual]", "0"}]},
          {
           FractionBox[
            RowBox[{"Ry", "+", 
             FractionBox[
              RowBox[{"Sin", "[", "\[Phi]\[Phi]", "]"}], "R0"], "-", "e2"}], 
            "e4"], "True"}
         }]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "\[Eta]\:306f", " ", 
        "e_list\:306e\:4ea4\:70b9\:3092\:3057\:3081\:3059\:5a92\:4ecb\:5909\
\:6570"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp", "[", "i_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["t", "L"], "\[Rule]", 
          RowBox[{
          "\[Eta]", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{
          SubscriptBox["\[Phi]", "A"], "\[Rule]", 
          RowBox[{
          "\[Phi]\[Phi]", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{
          SubscriptBox["t", "A"], "\[Rule]", 
          FractionBox[
           RowBox[{
            RowBox[{
            "\[Phi]\[Phi]", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "-", "R\[Theta]1"}], 
           RowBox[{"R\[Theta]2", "-", "R\[Theta]1"}]]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"work", " ", "=", " ", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"List", "[", 
             RowBox[{
              RowBox[{"temp", "[", "1", "]"}], ",", " ", 
              RowBox[{"temp", "[", "2", "]"}]}], "]"}], "\[IndentingNewLine]",
             ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "\[Eta]", "]"}], " ", "==", " ", "2"}], 
             " ", "&&", " ", 
             RowBox[{
              RowBox[{"\[Eta]", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", ">=", " ", "0.001"}], " ",
              "&&", " ", 
             RowBox[{
              RowBox[{"\[Eta]", "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", ">=", " ", 
              RowBox[{"\[Eta]", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"List", "[", 
             RowBox[{
              RowBox[{"temp", "[", "2", "]"}], ",", " ", 
              RowBox[{"temp", "[", "1", "]"}]}], "]"}], "\[IndentingNewLine]",
             ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "\[Eta]", "]"}], " ", "==", " ", "2"}], 
             " ", "&&", " ", 
             RowBox[{
              RowBox[{"\[Eta]", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", ">=", " ", "0.001"}], " ",
              "&&", " ", 
             RowBox[{
              RowBox[{"\[Eta]", "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", ">=", " ", "0.001"}]}]}], 
           "}"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"temp", "[", "1", "]"}], "}"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "\[Eta]", "]"}], " ", "==", " ", "2"}], 
             " ", "&&", " ", 
             RowBox[{
              RowBox[{"\[Eta]", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", ">=", " ", "0.001"}]}]}], 
           "}"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"temp", "[", "2", "]"}], "}"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "\[Eta]", "]"}], " ", "==", " ", "2"}], 
             " ", "&&", " ", 
             RowBox[{
              RowBox[{"\[Eta]", "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", ">=", " ", "0.001"}]}]}], 
           "}"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", " ", 
            RowBox[{
             RowBox[{"Length", "[", "\[Eta]", "]"}], " ", "==", " ", "2"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"temp", "[", "1", "]"}], "}"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "\[Eta]", "]"}], " ", "==", " ", "1"}], 
             " ", "&&", " ", 
             RowBox[{
              RowBox[{"\[Eta]", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", ">=", " ", "0.001"}]}]}], 
           "}"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", " ", 
            RowBox[{
             RowBox[{"Length", "[", "\[Eta]", "]"}], " ", "==", " ", "1"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", " ", "True"}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"case1", "-", "4"}], ":", 
         "\:4ea4\:70b9\:304c\:4e8c\:3064\:3042\:308b"}], "\:3002", " ", 
        RowBox[{"case1", "-", 
         RowBox[{"2", "\:4ea4\:70b9\:306e\:9806\:306b\:4e26\:3079\:308b"}]}], 
        "\:3002", " ", 
        RowBox[{"case3", "-", 
         RowBox[{
         "4", "\:306f\:4ea4\:7dda\:306e\:9032\:884c\:65b9\:5411\:306b\:306f\
\:4ea4\:70b9\:304c\:4e00\:3064\:3057\:304b\:306a\:3044"}]}], "\:3002", 
        RowBox[{
        "case6", ":", 
         "\:4ea4\:70b9\:304c\:305d\:3082\:305d\:3082\:4e00\:3064\:3057\:304b\
\:306a\:3044"}], "\:3002", " ", 
        RowBox[{
         RowBox[{"-", "0.001"}], "\:3068\:3057\:3066"}], "\:3001", 
        "\:ff10\:3067\:306a\:3044\:306e\:306f", "\:3001", 
        "\:6570\:5024\:8a08\:7b97\:3067", "\:3001", 
        RowBox[{
        "\:3068\:3066\:3082\:5c0f\:3055\:306a\:8ca0\:6570\:304c\:51fa\:3066\
\:304f\:308b\:30b1", "\:30fc", "\:30b9\:304c\:3042\:3063\:3066"}], "\:3001", 
        "\:4ea4\:70b9\:7121\:3057\:3068\:5224\:65ad\:3055\:308c\:3066\:3057\
\:307e\:3046\:305f\:3081", "\:3002"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"work", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cross", "\[Rule]", "0"}], ",", 
           RowBox[{
           "status", "\[Rule]", "\"\<CrossPoint out of region\>\""}]}], "}"}],
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"work2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"center", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Rx", ",", "Ry"}], "}"}]}], ",", 
         RowBox[{"invradius", "\[Rule]", " ", 
          RowBox[{"1", "/", "R0"}]}], ",", 
         RowBox[{"args", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"R\[Theta]1", ",", "R\[Theta]2"}], "}"}]}]}], "}"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"e1", "+", 
               RowBox[{"e3", " ", 
                SubscriptBox["t", "L"]}]}], ",", 
              RowBox[{"e2", "+", 
               RowBox[{"e4", " ", 
                SubscriptBox["t", "L"]}]}]}], "}"}], "/.", 
            RowBox[{
            "work", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ")"}], ",", 
          RowBox[{
           RowBox[{"Sign", "[", "rinv", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               FractionBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Phi]", "A"], "]"}], "R0"], ",", 
               FractionBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Phi]", "A"], "]"}], "R0"]}], "}"}], "/.", 
             "work2"}], ")"}]}], ",", "work"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cross", "\[Rule]", 
         RowBox[{"Length", "[", "work", "]"}]}], ",", 
        RowBox[{"pos", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"e1", "+", 
              RowBox[{"e3", " ", 
               SubscriptBox["t", "L"]}]}], ",", 
             RowBox[{"e2", "+", 
              RowBox[{"e4", " ", 
               SubscriptBox["t", "L"]}]}]}], "}"}], "/.", 
           RowBox[{"work", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}]}], 
        ",", 
        RowBox[{"tangent", "\[Rule]", " ", 
         RowBox[{"Normalize", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sign", "[", "rinv", "]"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               FractionBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Phi]", "A"], "]"}], "R0"], ",", 
               FractionBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Phi]", "A"], "]"}], "R0"]}], "}"}], "/.", 
             RowBox[{"work", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ")"}]}], 
          "]"}]}], ",", 
        RowBox[{"rayinfo", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Global`parametric", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"e1", "+", 
                 RowBox[{"e3", " ", "Global`t"}]}], ",", 
                RowBox[{"e2", "+", 
                 RowBox[{"e4", " ", "Global`t"}]}]}], "}"}]}], ",", 
             RowBox[{"Global`t", "\[Rule]", 
              SubscriptBox["t", "L"]}]}], "}"}], "/.", 
           RowBox[{
           "work", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ")"}]}], ",", " ", 
        RowBox[{"objinfo", "\[Rule]", "work2"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"crossPoint", "[", 
   RowBox[{
    RowBox[{"bd", ":", 
     RowBox[{"PatternSequence", "[", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"Global`type", "\[Rule]", "\"\<func\>\""}], ",", "___"}], 
       "}"}], "]"}]}], ",", 
    RowBox[{"ray", ":", 
     RowBox[{"PatternSequence", "[", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"Global`type", "\[Rule]", "\"\<ray\>\""}], ",", "___"}], 
       "}"}], "]"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "work", ",", "paramX", ",", "paramY", ",", "e1", ",", "e2", ",", "e3", 
      ",", "e4", ",", "paramray", ",", "parambd", ",", "cp", ",", "nearest"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"crosspoint", "[", 
        RowBox[{"bd", ",", "ray"}], "]"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"bd", ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"Global`function", "\[Rule]", "_"}], ",", "___"}], 
             "}"}]}], "]"}], "&&", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"bd", ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"Global`parametric", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"_", ",", "_"}], "}"}]}], ",", "___"}], "}"}]}], 
           "]"}]}], ")"}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"error", "\[Rule]", "\"\<Illigal Boundry Data\>\""}], ",", 
          RowBox[{"Global`function", "\[Rule]", "\"\<crossPoint\>\""}], ",", 
          " ", 
          RowBox[{"arg", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"bd", ",", "ray"}], "}"}]}]}], "}"}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"ray", ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"Global`org", "\[Rule]", "_"}], ",", "___"}], "}"}]}], 
           "]"}], "&&", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"ray", ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"Global`vec", "\[Rule]", "_"}], ",", "___"}], "}"}]}], 
           "]"}]}], ")"}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"error", "\[Rule]", "\"\<Illigal Ray Data\>\""}], ",", 
          RowBox[{"Global`function", "\[Rule]", "\"\<crossPoint\>\""}], ",", 
          " ", 
          RowBox[{"arg", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"bd", ",", "ray"}], "}"}]}]}], "}"}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"paramX", ",", "paramY"}], "}"}], "=", 
       RowBox[{"Global`parametric", "/.", "bd"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e1", ",", "e2"}], "}"}], "=", 
       RowBox[{"(", 
        RowBox[{"Global`org", "/.", "ray"}], ")"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e3", ",", "e4"}], "}"}], "=", 
       RowBox[{"(", 
        RowBox[{"Global`vec", "/.", "ray"}], ")"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Global`function", "/.", "bd"}], ")"}], "[", 
         RowBox[{"paramX", ",", "paramY"}], "]"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"parambd", "=", 
      RowBox[{"Global`parametric", "/.", "bd"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"paramray", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"e1", "+", 
         RowBox[{"Global`t", " ", "e3"}]}], ",", 
        RowBox[{"e2", "+", 
         RowBox[{"Global`t", " ", "e4"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cp", "[", "\"\<ray\>\"", "]"}], "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Global`function", "/.", "bd"}], ")"}], "@@", "paramray"}],
          "\[Equal]", "0"}], ",", "Global`t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cp", "[", "\"\<bd\>\"", "]"}], "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], ",", 
             RowBox[{
              RowBox[{"e4", 
               RowBox[{"(", 
                RowBox[{"x", "-", "e1"}], ")"}]}], "-", 
              RowBox[{"e3", 
               RowBox[{"(", 
                RowBox[{"y", "-", "e2"}], ")"}]}]}]}], "]"}], "@@", 
           "parambd"}], "\[Equal]", "0"}], "&&", 
         RowBox[{
         "0", "\[LessEqual]", " ", "Global`t", "\[LessEqual]", "1"}]}], ",", 
        "Global`t"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Global`parametric", "/.", 
           RowBox[{"v2p", "[", "ray", "]"}]}], ")"}], "/.", 
         RowBox[{"cp", "[", "\"\<ray\>\"", "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"work", "[", "\"\<nmv\>\"", "]"}], "=", 
      RowBox[{"Normalize", "@", 
       RowBox[{"{", 
        RowBox[{"e3", ",", "e4"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"cp", "[", "\"\<bd\>\"", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cross", "\[Rule]", "0"}], ",", 
          RowBox[{"status", "\[Rule]", "\"\<No Cross Point\>\""}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", "_", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"cp", "[", "\"\<list\>\"", "]"}], "=", 
         RowBox[{"parambd", "/.", 
          RowBox[{"cp", "[", "\"\<bd\>\"", "]"}]}]}], ";", 
        RowBox[{
         RowBox[{"work", "[", "\"\<dstlst\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "-", 
              RowBox[{"{", 
               RowBox[{"e1", ",", "e2"}], "}"}]}], ")"}], ".", 
            RowBox[{"work", "[", "\"\<nmv\>\"", "]"}]}], "&"}], "/@", 
          RowBox[{"cp", "[", "\"\<list\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"work", "[", "\"\<idxlst\>\"", "]"}], "=", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"work", "[", "\"\<dstlst\>\"", "]"}], ",", 
               RowBox[{"_", "?", "Positive"}]}], "]"}]}], ")"}], "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"cross", "\[Rule]", "0"}], ",", 
             RowBox[{"status", "\[Rule]", "\"\<No Cross Point\>\""}]}], "}"}],
            "]"}]}], "]"}], ";", 
        RowBox[{
         RowBox[{"work", "[", "\"\<idxsrt\>\"", "]"}], "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"work", "[", "\"\<idxlst\>\"", "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"work", "[", "\"\<dstlst\>\"", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{
              "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[RightDoubleBracket]"}], "<", 
             RowBox[{
              RowBox[{"work", "[", "\"\<dstlst\>\"", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{
              "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[RightDoubleBracket]"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"work", "[", "\"\<crspos\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"cp", "[", "\"\<list\>\"", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"work", "[", "\"\<idxsrt\>\"", "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"work", "[", "\"\<crspara\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"cp", "[", "\"\<bd\>\"", "]"}], "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"work", "[", "\"\<idxsrt\>\"", "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"work", "[", "\"\<crspararay\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{"cp", "[", "\"\<ray\>\"", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"paramray", "/.", 
                  RowBox[{
                  "#1", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ")"}], "-", 
                RowBox[{"work", "[", "\"\<crspos\>\"", "]"}]}], "]"}], "<", 
              RowBox[{"Norm", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"paramray", "/.", 
                  RowBox[{
                  "#2", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ")"}], "-", 
                RowBox[{"work", "[", "\"\<crspos\>\"", "]"}]}], "]"}]}], 
             "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"work", "[", "\"\<tange\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"parambd", ",", "Global`t"}], "]"}], "/.", 
          RowBox[{"work", "[", "\"\<crspara\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cross", "\[Rule]", 
           RowBox[{"Length", "[", 
            RowBox[{"work", "[", "\"\<idxsrt\>\"", "]"}], "]"}]}], ",", 
          RowBox[{"pos", "\[Rule]", 
           RowBox[{"work", "[", "\"\<crspos\>\"", "]"}]}], ",", 
          RowBox[{"tangent", "\[Rule]", 
           RowBox[{"Normalize", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"work", "[", "\"\<tange\>\"", "]"}], 
               "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
              " ", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"work", "[", "\"\<tange\>\"", "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
             "}"}]}]}], ",", 
          RowBox[{"rayinfo", "\[Rule]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"Global`parametric", "\[Rule]", " ", "paramray"}], ",", 
             RowBox[{
              RowBox[{"work", "[", "\"\<crspararay\>\"", "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "}"}]}], ",", 
          RowBox[{"objinfo", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Global`parametric", "\[Rule]", "parambd"}], ",", 
             RowBox[{"work", "[", "\"\<crspara\>\"", "]"}], ",", 
             RowBox[{"other", "->", 
              RowBox[{"(", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"cp", "[", "\"\<bd\>\"", "]"}], 
                   "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
                  "&"}], "/@", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"work", "[", "\"\<idxsrt\>\"", "]"}]}]}], ")"}], 
               ")"}]}]}], "}"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6187441932815423`*^9, 3.618744193557558*^9}, {
   3.6187442389911566`*^9, 3.618744259975357*^9}, {3.6187443128583817`*^9, 
   3.6187444044686213`*^9}, {3.6187444354423933`*^9, 
   3.6187444411107173`*^9}, {3.6187451287170463`*^9, 3.618745159968834*^9}, {
   3.618745776672107*^9, 3.6187457851705933`*^9}, {3.618787626262895*^9, 
   3.6187877076045475`*^9}, {3.6187880756075964`*^9, 
   3.6187881628895884`*^9}, {3.6187882564449396`*^9, 3.618788293748073*^9}, {
   3.6187885920571356`*^9, 3.618788606505962*^9}, {3.6189031685261173`*^9, 
   3.6189031709672565`*^9}, {3.6189035586504307`*^9, 3.618903562583656*^9}, {
   3.6189035969696226`*^9, 3.6189036024779377`*^9}, {3.6189038396605034`*^9, 
   3.6189038972847996`*^9}, {3.61890412615489*^9, 3.6189041382245803`*^9}, {
   3.6189042471798124`*^9, 3.6189042623086777`*^9}, {3.618904312542551*^9, 
   3.618904331072611*^9}, {3.6189043826795626`*^9, 3.618904518359323*^9}, {
   3.618905747180608*^9, 3.618905749621747*^9}, {3.6189059112529917`*^9, 
   3.618905928190961*^9}, {3.6189067421155148`*^9, 3.6189067423925304`*^9}, {
   3.618907039095501*^9, 3.618907105992327*^9}, {3.618907141118336*^9, 
   3.6189072207368903`*^9}, {3.618907499316824*^9, 3.6189075047111325`*^9}, {
   3.6189079086602373`*^9, 3.618907963940399*^9}, {3.6189080672233067`*^9, 
   3.6189080983550873`*^9}, {3.618908187444183*^9, 3.6189081897383137`*^9}, {
   3.6189083757409525`*^9, 3.6189084278549337`*^9}, {3.6189085298537674`*^9, 
   3.61890861644372*^9}, {3.618908651353717*^9, 3.618908770556535*^9}, {
   3.618923570812742*^9, 3.618923632363262*^9}, {3.618923674938698*^9, 
   3.6189236820701056`*^9}, {3.618923970889625*^9, 3.6189239726797276`*^9}, {
   3.6189240528623133`*^9, 3.6189240530883265`*^9}, {3.6189562194769955`*^9, 
   3.6189562252963285`*^9}, {3.6189562562320976`*^9, 
   3.6189562608073597`*^9}, {3.618964622851641*^9, 3.618964659622744*^9}, {
   3.6189647060834017`*^9, 3.618964706817444*^9}, {3.6189661773335524`*^9, 
   3.618966212362556*^9}, {3.6189663743798227`*^9, 3.6189663755668907`*^9}, {
   3.6189664060586348`*^9, 3.618966477765736*^9}, {3.618966519723136*^9, 
   3.6189665365400977`*^9}, {3.6189666427301717`*^9, 
   3.6189666546388526`*^9}, {3.618966703111625*^9, 3.61896675407154*^9}, {
   3.618966904119122*^9, 3.618966907800333*^9}, {3.6189669473475943`*^9, 
   3.618966950377768*^9}, {3.618966986337825*^9, 3.618967033054497*^9}, {
   3.618967063893261*^9, 3.618967104290571*^9}, {3.6189671751066217`*^9, 
   3.6189671870383043`*^9}, {3.6189672583263817`*^9, 3.618967309141288*^9}, {
   3.6189680796703596`*^9, 3.6189681215957575`*^9}, {3.6189683741962056`*^9, 
   3.618968377180376*^9}, {3.618968892646859*^9, 3.6189688978941593`*^9}, {
   3.6189689599247074`*^9, 3.6189689637419257`*^9}, {3.6189693049254403`*^9, 
   3.6189694198990164`*^9}, {3.618969495853361*^9, 3.618969551245529*^9}, {
   3.618969633347225*^9, 3.618969678100785*^9}, 3.618970863641594*^9, 
   3.618971125424567*^9, {3.6189711579794292`*^9, 3.6189711697050996`*^9}, {
   3.618971208642327*^9, 3.618971283070584*^9}, {3.618971354023642*^9, 
   3.618971568575914*^9}, {3.6189759957961364`*^9, 3.6189760203935432`*^9}, {
   3.618976350169405*^9, 3.618976392715839*^9}, {3.618977376522109*^9, 
   3.6189774868124175`*^9}, {3.618977524642581*^9, 3.6189775839819756`*^9}, {
   3.61915263025799*^9, 3.6191526659190297`*^9}, {3.619155435788457*^9, 
   3.61915545140135*^9}, {3.6242923543989954`*^9, 3.6242923651236086`*^9}, {
   3.624293403404995*^9, 3.624293493769163*^9}, {3.624356102661872*^9, 
   3.6243561267959056`*^9}, {3.6243562856901298`*^9, 3.624356289850136*^9}, {
   3.6243564003632917`*^9, 3.6243564440943537`*^9}, {3.62435650561444*^9, 
   3.624356580925546*^9}, {3.6243566410836306`*^9, 3.624356659788657*^9}, {
   3.624356700380715*^9, 3.624356722085746*^9}, {3.624356788143839*^9, 
   3.6243567940548472`*^9}, {3.6243568527599306`*^9, 3.624356898119994*^9}, {
   3.6243569392780523`*^9, 3.6243569921831274`*^9}, 3.6243571043872857`*^9, {
   3.624361979940169*^9, 3.624362017117221*^9}, {3.6243664426459246`*^9, 
   3.624366442905925*^9}, {3.6244872851814456`*^9, 3.6244873015023794`*^9}, {
   3.624490471646701*^9, 3.624490570073331*^9}, {3.6245008349534483`*^9, 
   3.6245008399357333`*^9}, {3.6245070575543604`*^9, 
   3.6245071087902913`*^9}, {3.6245218843804064`*^9, 
   3.6245218880866184`*^9}, {3.6245354357435904`*^9, 
   3.6245354490476093`*^9}, {3.6245355065416903`*^9, 3.6245355334867287`*^9}, 
   3.6245355728777847`*^9, {3.624535610587839*^9, 3.62453561111784*^9}, {
   3.6245356619019113`*^9, 3.624535687316947*^9}, {3.6245357913800955`*^9, 
   3.6245359299522915`*^9}, {3.6245359660593433`*^9, 3.624535969570348*^9}, {
   3.624536928805709*^9, 3.6245369738757725`*^9}, {3.624537014963831*^9, 
   3.624537040877867*^9}, {3.6245371283869905`*^9, 3.624537187417074*^9}, 
   3.624537493794526*^9, 3.6245376987608232`*^9, {3.6245378266960077`*^9, 
   3.624537827166009*^9}, {3.624541574713153*^9, 3.624541595188182*^9}, {
   3.624752821881178*^9, 3.624752822381179*^9}, {3.6247536529300785`*^9, 
   3.6247536813402834`*^9}, {3.624759750531703*^9, 3.624759752601706*^9}, {
   3.6247598605578594`*^9, 3.6247598633978634`*^9}, {3.624760330758524*^9, 
   3.624760332339526*^9}, {3.624765566612916*^9, 3.6247655762339296`*^9}, 
   3.6247656482460318`*^9, 3.624765875880353*^9, {3.638672393255462*^9, 
   3.6386723950357466`*^9}, {3.638692137302126*^9, 3.6386922252515535`*^9}, {
   3.6387967906251025`*^9, 3.638796791979083*^9}, {3.638798682950736*^9, 
   3.6387987400522947`*^9}, 3.6392903160682034`*^9, {3.639290798900565*^9, 
   3.6392922245043297`*^9}, {3.6392927162910447`*^9, 
   3.6392927167883797`*^9}, {3.639293154395583*^9, 3.639293212067594*^9}, {
   3.639296053506884*^9, 3.6392961078335314`*^9}, {3.639299594703068*^9, 
   3.639299632070639*^9}, {3.639303602072875*^9, 3.6393042848614063`*^9}, {
   3.6393047087628255`*^9, 3.63930500873414*^9}, {3.639305615994969*^9, 
   3.6393060116823683`*^9}, {3.6393063594156265`*^9, 
   3.6393063665597324`*^9}, {3.6393066789968824`*^9, 
   3.6393069192607365`*^9}, {3.63930824599621*^9, 3.639308516912845*^9}, 
   3.6393129830448694`*^9, {3.6393138852464533`*^9, 3.6393141342194834`*^9}, {
   3.6393148301803885`*^9, 3.6393151235930405`*^9}, {3.639315750420782*^9, 
   3.639315894468215*^9}, 3.6393195423719025`*^9, {3.6394501662703233`*^9, 
   3.639450956795491*^9}, {3.6411019156508694`*^9, 3.6411022855371847`*^9}, {
   3.6411035310892043`*^9, 3.641104317219349*^9}, {3.6411140943270383`*^9, 
   3.6411156044816923`*^9}, 3.6411164181666813`*^9, {3.6411187848221235`*^9, 
   3.64111884070887*^9}, 3.641120181929512*^9, 3.6411226242049828`*^9, {
   3.641123214352635*^9, 3.6411237863013654`*^9}, {3.641124316618565*^9, 
   3.6411249379133143`*^9}, {3.6411253256069517`*^9, 3.641126062848096*^9}, {
   3.6411269155097165`*^9, 3.6411284023385963`*^9}, {3.6417301337753735`*^9, 
   3.641732250291631*^9}, {3.6417338103422437`*^9, 3.641734471746256*^9}, 
   3.641735516909835*^9, {3.6544659586544313`*^9, 3.6544659934912176`*^9}, {
   3.6761121996884403`*^9, 3.6761122099186745`*^9}, {3.6761129727224245`*^9, 
   3.676113031312476*^9}, {3.6761133869072957`*^9, 3.676113391560143*^9}, {
   3.676114064931615*^9, 3.6761140924730115`*^9}, {3.676114181044286*^9, 
   3.676114227488648*^9}, {3.676114274083649*^9, 3.676114290051817*^9}, 
   3.6761150358930206`*^9, {3.6761151052183123`*^9, 3.6761151227377596`*^9}, {
   3.676115748335313*^9, 3.6761157750283575`*^9}, 3.6761159086816254`*^9, {
   3.6761160079480844`*^9, 3.6761160703206987`*^9}, 3.676116255360808*^9, {
   3.6761163094585533`*^9, 3.676116568248942*^9}, {3.676116642933362*^9, 
   3.6761167487381*^9}, {3.6761167932153835`*^9, 3.6761168256389856`*^9}, {
   3.685842005672276*^9, 3.685842012119937*^9}, {3.6858421635588446`*^9, 
   3.6858421644693613`*^9}, 3.685842197164908*^9, {3.6858422459650183`*^9, 
   3.685842260743255*^9}, {3.685842326580397*^9, 3.6858423295342445`*^9}, 
   3.6858423920813313`*^9, 3.6858424552598133`*^9, {3.685842501764876*^9, 
   3.68584250398927*^9}, {3.6858425348091173`*^9, 3.6858426101947665`*^9}, {
   3.6858467331020217`*^9, 3.6858467575154653`*^9}, {3.68584681429303*^9, 
   3.6858468540334187`*^9}, {3.6858473347860603`*^9, 3.685847360084005*^9}, {
   3.6858476286184015`*^9, 3.6858476315863695`*^9}, 3.6858477058435345`*^9, {
   3.6858477416903067`*^9, 3.6858478508637047`*^9}, {3.6858479106993837`*^9, 
   3.685847994378874*^9}, {3.685848027470501*^9, 3.6858480348874207`*^9}, {
   3.685848084096051*^9, 3.68584812129097*^9}, {3.685848159365218*^9, 
   3.68584819237473*^9}, {3.685848288191269*^9, 3.68584830084266*^9}, {
   3.685848754081148*^9, 3.685848756336645*^9}, {3.685849934098654*^9, 
   3.685849937562949*^9}, 3.6858500691972427`*^9, {3.6858502324104724`*^9, 
   3.685850271491389*^9}, {3.6858503350714407`*^9, 3.685850336230212*^9}, {
   3.685850404984043*^9, 3.685850476417122*^9}, {3.685850514774556*^9, 
   3.685850525124419*^9}, {3.685850563226686*^9, 3.685850569572894*^9}, 
   3.685850715022346*^9, {3.6858508718090296`*^9, 3.6858509293973904`*^9}, {
   3.685858876742857*^9, 3.685858913787603*^9}, {3.6858590548392487`*^9, 
   3.6858591192915726`*^9}, 3.685859266323307*^9, {3.6858663033377333`*^9, 
   3.68586639541385*^9}, {3.6858664279947653`*^9, 3.685866434648263*^9}, {
   3.6858665458768187`*^9, 3.6858665739283037`*^9}, {3.6858667117555885`*^9, 
   3.685866714008112*^9}, {3.6858667541474557`*^9, 3.685866762192895*^9}, {
   3.685868612649753*^9, 3.685868893944543*^9}, {3.685868977019351*^9, 
   3.685869049247566*^9}, {3.685869112447301*^9, 3.685869240267249*^9}, 
   3.685869282984058*^9, {3.6858699215429716`*^9, 3.685869944435035*^9}, {
   3.6858700847471504`*^9, 3.685870099386424*^9}, {3.6858702392313585`*^9, 
   3.6858702397276983`*^9}, 3.685870364206403*^9, {3.6858704375274043`*^9, 
   3.685870455545703*^9}, 3.685870530489909*^9, {3.6858706129387856`*^9, 
   3.6858706319917912`*^9}, 3.685870720837162*^9, {3.6858708441531343`*^9, 
   3.685870849576689*^9}, {3.685870929758943*^9, 3.68587102136489*^9}, {
   3.685871096962366*^9, 3.6858712979591875`*^9}, {3.6858713345059013`*^9, 
   3.68587142210744*^9}, {3.6858714684968753`*^9, 3.6858715528791647`*^9}, 
   3.685871660154853*^9, {3.6858718609811983`*^9, 3.685871882300064*^9}, {
   3.6858719304879093`*^9, 3.6858720356121225`*^9}, {3.685872075420599*^9, 
   3.6858721002841597`*^9}, {3.685872138547581*^9, 3.6858721882279844`*^9}, 
   3.6858722539311895`*^9, {3.6858723271348696`*^9, 3.685872478866519*^9}, {
   3.6858725472837677`*^9, 3.685872587533985*^9}, {3.685872744575159*^9, 
   3.6858728495687447`*^9}, {3.685872889114069*^9, 3.6858729150659103`*^9}, 
   3.685872990475272*^9, 3.6858735184993734`*^9, {3.6858737915215235`*^9, 
   3.685873795355384*^9}, 3.685874004279942*^9, {3.6858740551816597`*^9, 
   3.6858740673231792`*^9}, {3.6858741175670247`*^9, 
   3.6858741353274856`*^9}, {3.685874172874999*^9, 3.685874246712437*^9}, {
   3.685874304903735*^9, 3.6858743326997075`*^9}, {3.685874375571701*^9, 
   3.6858743777261705`*^9}, {3.6858746064048443`*^9, 3.685874642106214*^9}, {
   3.6858746730846105`*^9, 3.6858747371483736`*^9}, {3.6858747922880473`*^9, 
   3.6858748143070774`*^9}, 3.685874859713438*^9, 3.685874948800347*^9, {
   3.685875018615741*^9, 3.6858750220710773`*^9}, {3.685875092061694*^9, 
   3.685875122762453*^9}, 3.6858753107609873`*^9, {3.6858753741134644`*^9, 
   3.685875401923269*^9}, 3.6858755050911546`*^9, {3.685875627171708*^9, 
   3.685875631657742*^9}, 3.6858757722618327`*^9, {3.6858758845066104`*^9, 
   3.685875893324574*^9}, 3.68587612295002*^9, 3.685876171671963*^9, 
   3.6858765009656916`*^9, {3.6858773283846865`*^9, 3.6858773343487215`*^9}, {
   3.6859215012856555`*^9, 3.685921536726649*^9}, {3.6859215853941917`*^9, 
   3.6859216102863235`*^9}, {3.6859216536428185`*^9, 3.6859216656189485`*^9}, 
   3.6859217040764446`*^9, {3.6859242351726913`*^9, 3.6859242358162556`*^9}, 
   3.685924306453513*^9, {3.6859243450145626`*^9, 3.685924352444173*^9}, 
   3.685924777970788*^9, {3.6859256646920185`*^9, 3.6859256727677975`*^9}, {
   3.6859260943851657`*^9, 3.6859262095755296`*^9}, {3.685926652336483*^9, 
   3.685926683201718*^9}, {3.6859290065415716`*^9, 3.685929050735419*^9}, {
   3.6859290916726313`*^9, 3.6859291400896792`*^9}, {3.6859293166522675`*^9, 
   3.685929322493004*^9}, {3.685948886700077*^9, 3.6859488880950227`*^9}, {
   3.68594990451031*^9, 3.685949907418262*^9}, {3.685960187524324*^9, 
   3.6859602044806423`*^9}, {3.6859627191523504`*^9, 
   3.6859627712927704`*^9}, {3.6859636154317255`*^9, 
   3.6859636182487245`*^9}, {3.6859650409304924`*^9, 3.685965041736951*^9}, {
   3.685965097416731*^9, 3.6859650985140076`*^9}, {3.6859653192529993`*^9, 
   3.6859653273363743`*^9}, {3.68596538745236*^9, 3.6859653998200817`*^9}, {
   3.685965545626667*^9, 3.685965639065445*^9}, {3.6859657093412027`*^9, 
   3.685965720300022*^9}, {3.685965793691668*^9, 3.6859658094871645`*^9}, {
   3.685965840886628*^9, 3.685965859332947*^9}, {3.6859659138022776`*^9, 
   3.685965936545943*^9}, {3.68596596715584*^9, 3.685966063419263*^9}, {
   3.685966098681885*^9, 3.6859661045705338`*^9}, {3.6859666690372934`*^9, 
   3.685966727292113*^9}, 3.685966882999076*^9, {3.685966964554495*^9, 
   3.6859669684715447`*^9}, {3.68596718636255*^9, 3.68596729906668*^9}, 
   3.6859675042593184`*^9, {3.6859675658160257`*^9, 3.6859675856222363`*^9}, 
   3.685967732191227*^9, {3.6859678177471695`*^9, 3.6859678395479035`*^9}, {
   3.6859679903387566`*^9, 3.6859681166675763`*^9}, {3.685968302732879*^9, 
   3.685968555429261*^9}, 3.6859692059076815`*^9, 3.6859692755959296`*^9, {
   3.6859704730509357`*^9, 3.685970474167241*^9}, {3.685972244504988*^9, 
   3.685972245158569*^9}, {3.6859723802188673`*^9, 3.685972393884633*^9}, {
   3.685974972001213*^9, 3.6859749851276145`*^9}, {3.6860548321979194`*^9, 
   3.686054904771742*^9}, {3.6860550034450493`*^9, 3.6860550169867735`*^9}, {
   3.6860550888293595`*^9, 3.68605516149922*^9}, {3.686055193366776*^9, 
   3.686055198945054*^9}, {3.6860553325397882`*^9, 3.68605533364426*^9}, {
   3.686055371070222*^9, 3.686055372457284*^9}, {3.6860558880532093`*^9, 
   3.6860559228386927`*^9}, {3.686055972531336*^9, 3.6860561107529597`*^9}, {
   3.686056174312291*^9, 3.686056187060644*^9}, {3.6860562224490895`*^9, 
   3.686056511918029*^9}, {3.68605660566181*^9, 3.6860566125150633`*^9}, {
   3.686056740093902*^9, 3.6860568277542048`*^9}, {3.686058342320619*^9, 
   3.6860585792673726`*^9}, {3.6860586321948385`*^9, 
   3.6860586701878667`*^9}, {3.6860587569728155`*^9, 3.686058805020226*^9}, 
   3.686059076138976*^9, {3.686060316295207*^9, 3.686060357506025*^9}, {
   3.686060671106522*^9, 3.6860607111437087`*^9}, {3.686061697825239*^9, 
   3.686061710757977*^9}, 3.6860617430046864`*^9, {3.6861073865205965`*^9, 
   3.686107388072601*^9}, {3.6861075927564716`*^9, 3.686107600557845*^9}, {
   3.6861078248961535`*^9, 3.686107843250595*^9}, 3.6861078740269146`*^9, {
   3.686107904389784*^9, 3.6861080241765423`*^9}, {3.686108061620929*^9, 
   3.6861080642561817`*^9}, {3.686108108535493*^9, 3.686108108927803*^9}, {
   3.686109290361284*^9, 3.686109292714097*^9}, {3.6861093722647767`*^9, 
   3.686109377370473*^9}, {3.686109555852127*^9, 3.68610984793544*^9}, {
   3.6861099059524965`*^9, 3.6861099755581646`*^9}, {3.686110013220911*^9, 
   3.6861100438861485`*^9}, {3.686110133542251*^9, 3.68611015371875*^9}, {
   3.6861102097480474`*^9, 3.6861103679849772`*^9}, {3.686110518876044*^9, 
   3.68611051937493*^9}, {3.6861105631822605`*^9, 3.6861105643200684`*^9}, {
   3.686110842326151*^9, 3.686110846619468*^9}, {3.686111279163348*^9, 
   3.6861113053837204`*^9}, {3.686111442118927*^9, 3.686111468276266*^9}, {
   3.6861115088605294`*^9, 3.686111534846996*^9}, {3.686111568416067*^9, 
   3.6861116356185117`*^9}, {3.686111788581359*^9, 3.6861117982880254`*^9}, {
   3.6861131705262256`*^9, 3.686113174816054*^9}, {3.686113224380336*^9, 
   3.68611325153376*^9}, {3.6861135351006517`*^9, 3.6861135357571583`*^9}, {
   3.6861153650320196`*^9, 3.68611537087177*^9}, {3.6861155669845233`*^9, 
   3.686115587885063*^9}, {3.68611562140164*^9, 3.686115654091607*^9}, {
   3.686116336057685*^9, 3.6861163367570333`*^9}, {3.6861164874345913`*^9, 
   3.6861164880952883`*^9}, {3.686116536841524*^9, 3.686116609362908*^9}, {
   3.6861174200561013`*^9, 3.6861174423122263`*^9}, {3.686117474931404*^9, 
   3.686117476901077*^9}, {3.6861175750280457`*^9, 3.686117651582605*^9}, {
   3.686117742148692*^9, 3.686117749117176*^9}, {3.686117818446418*^9, 
   3.686117819602721*^9}, 3.6861187443880453`*^9, {3.686120018167551*^9, 
   3.686120038470818*^9}, {3.686120553037941*^9, 3.6861205546435237`*^9}, {
   3.6861238298339324`*^9, 3.6861238991152425`*^9}, {3.6861239400676875`*^9, 
   3.686123943765939*^9}, {3.6861239792681956`*^9, 3.6861241646813173`*^9}, {
   3.6861242961435027`*^9, 3.6861243186117163`*^9}, {3.68612438649314*^9, 
   3.6861244156203184`*^9}, 3.686124452078042*^9, {3.686124522561049*^9, 
   3.686124529977756*^9}, {3.6861245610366735`*^9, 3.686124565830041*^9}, {
   3.686124614965041*^9, 3.6861246321726365`*^9}, {3.6861287817852993`*^9, 
   3.6861288913332863`*^9}, 3.6861293641867995`*^9, {3.6861296758670855`*^9, 
   3.686129686874813*^9}, {3.686129726407363*^9, 3.6861297478497577`*^9}, 
   3.6861313317084885`*^9, {3.6861314034866576`*^9, 3.686131417290513*^9}, {
   3.6861318800086327`*^9, 3.6861318861134315`*^9}, {3.6861319540188193`*^9, 
   3.686131970064263*^9}, {3.686132004040887*^9, 3.686132075727118*^9}, 
   3.686132554588035*^9, {3.686139570505186*^9, 3.68613957601886*^9}, {
   3.686139671854794*^9, 3.686139693085908*^9}, {3.686141274632894*^9, 
   3.6861412800457516`*^9}, {3.686143596567089*^9, 3.686143602983985*^9}, {
   3.6861437790729885`*^9, 3.6861437814481*^9}, {3.6861450060233593`*^9, 
   3.686145014888275*^9}, {3.6861458427963676`*^9, 3.6861459068715696`*^9}, {
   3.686146018315953*^9, 3.6861460407948933`*^9}, {3.6861790976566095`*^9, 
   3.686179120981944*^9}, {3.6861792803577585`*^9, 3.6861792810164948`*^9}, {
   3.686179566788604*^9, 3.686179573729271*^9}, {3.686179681777985*^9, 
   3.686179697217461*^9}, {3.686182000882159*^9, 3.6861820163144264`*^9}, {
   3.68618207757908*^9, 3.6861821114464903`*^9}, {3.686191134509198*^9, 
   3.686191243326863*^9}, {3.6861912885994234`*^9, 3.6861913092044535`*^9}, {
   3.686191339521725*^9, 3.686191349332445*^9}, {3.686191389924746*^9, 
   3.6861915225305943`*^9}, {3.6861915614078054`*^9, 3.686191562378172*^9}, {
   3.686191600060382*^9, 3.6861916156269293`*^9}, {3.6861916521064153`*^9, 
   3.68619167201724*^9}, {3.6861917175549564`*^9, 3.686191829542725*^9}, {
   3.686191984400652*^9, 3.686192142690322*^9}, {3.6861921824909315`*^9, 
   3.686192201542096*^9}, {3.6861926513601046`*^9, 3.6861926857086167`*^9}, {
   3.6861979350197573`*^9, 3.6861979972340727`*^9}, {3.686198169115837*^9, 
   3.6861981729871635`*^9}, {3.686198206552744*^9, 3.6861983209353924`*^9}, {
   3.6862347503585424`*^9, 3.6862347623917236`*^9}, 3.686235379467967*^9, {
   3.6862355216331797`*^9, 3.686235534745367*^9}, {3.686235861907467*^9, 
   3.6862359354779696`*^9}, {3.686235986272565*^9, 3.6862359889557333`*^9}, {
   3.686260960114748*^9, 3.6862610258134174`*^9}, {3.6862612868465652`*^9, 
   3.68626128920146*^9}, {3.686268523454054*^9, 3.6862685275096273`*^9}, {
   3.686281536805872*^9, 3.686281538413142*^9}, {3.686281774800131*^9, 
   3.6862817959143972`*^9}, 3.686282541684342*^9, {3.686282652095713*^9, 
   3.6862828219584775`*^9}, {3.6862828548884945`*^9, 3.686282857852601*^9}, {
   3.686284983712947*^9, 3.6862849870984373`*^9}, {3.6862850758926506`*^9, 
   3.6862850790935464`*^9}, {3.686285928348922*^9, 3.6862859284279823`*^9}, {
   3.686286950000743*^9, 3.68628695090816*^9}, {3.686286982938553*^9, 
   3.6862869912729745`*^9}, {3.68628702403634*^9, 3.686287031586485*^9}, 
   3.6862871025765104`*^9, {3.686287171862968*^9, 3.6862871726001573`*^9}, {
   3.7339934554365163`*^9, 3.733993523639289*^9}, 3.7339936228855057`*^9, {
   3.7339937089861536`*^9, 3.733993710241621*^9}, 3.733993745599476*^9, 
   3.7360363888303223`*^9, {3.767655684963291*^9, 3.7676557078934135`*^9}, {
   3.7676557664005985`*^9, 3.7676557971270075`*^9}, {3.7676558523216867`*^9, 
   3.767655853501957*^9}, {3.767655896337968*^9, 3.7676559267949057`*^9}, {
   3.7676560098830123`*^9, 3.7676560110318103`*^9}, {3.767656091129154*^9, 
   3.7676561154027815`*^9}, {3.7676561677670536`*^9, 
   3.7676561908343983`*^9}, {3.767656225488513*^9, 3.767656227623475*^9}, {
   3.7676562613009443`*^9, 3.767656261854145*^9}, {3.767656845525468*^9, 
   3.767656904440894*^9}, {3.7676569527924924`*^9, 3.767656972091364*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"4457be58-6539-4337-9cf7-2b1d25707bf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7664597505871325`*^9},ExpressionUUID->"06af5f88-107a-4c10-b0d3-\
7ac18c7c03e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7339942028767796`*^9, 3.7339942121998234`*^9}, {
  3.7664597391326585`*^9, 
  3.766459751588174*^9}},ExpressionUUID->"0e8d89d6-b252-4417-bb75-\
0c874721e536"],

Cell[BoxData["\<\"rayTrace2D`Private`\"\>"], "Output",
 CellChangeTimes->{3.733994246105506*^9, 3.7339943801704607`*^9, 
  3.733995561892529*^9, 3.736037454870474*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"671177a8-4398-4de5-9363-10e7a4f169bc"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 725},
WindowMargins->{{-8, Automatic}, {720, Automatic}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (2018\:5e743\:670812\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 335, 5, 34, "Text",ExpressionUUID->"7b0f4cff-1845-40b9-81db-39aad5a16217"],
Cell[CellGroupData[{
Cell[918, 29, 200, 3, 28, "Input",ExpressionUUID->"6d8c9cd3-d8e2-440b-bc9a-e12599b47063"],
Cell[1121, 34, 278, 6, 22, "Print",ExpressionUUID->"8db1c604-b2a3-4d9f-8060-960cf225ebeb"]
}, Open  ]],
Cell[1414, 43, 1026, 17, 100, "Text",ExpressionUUID->"80ce0e59-2d6a-427f-aabd-ace7b51290ae"],
Cell[CellGroupData[{
Cell[2465, 64, 627, 13, 47, "Input",ExpressionUUID->"66f5f648-2583-438d-8b80-d0f812b1b3a3"],
Cell[3095, 79, 655, 9, 32, "Output",ExpressionUUID->"8a2a3883-ef49-4228-9170-984e9b5cdce6"]
}, Open  ]],
Cell[3765, 91, 627, 10, 34, "Text",ExpressionUUID->"f09f2183-06e3-4014-8e39-0b90e1dab1a4"],
Cell[4395, 103, 368, 5, 45, "Input",ExpressionUUID->"31ef5261-5d48-43ca-b767-70640ca539e6"],
Cell[CellGroupData[{
Cell[4788, 112, 203, 3, 28, "Input",ExpressionUUID->"83b485bb-e757-4774-ae0d-08573199093c"],
Cell[4994, 117, 53887, 936, 438, "Output",ExpressionUUID->"373baf17-4024-490e-9de6-7aa5778cbe6b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58918, 1058, 421, 6, 48, "Input",ExpressionUUID->"c31cbddf-18cd-4c5c-9f4e-666c880d1e1a"],
Cell[59342, 1066, 2284, 64, 56, "Print",ExpressionUUID->"5b03a951-11ec-49a6-9e02-573af318f60c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61663, 1135, 379, 6, 53, "Subsection",ExpressionUUID->"c6e203fc-1b77-47a6-9964-cc3565f21d0b"],
Cell[62045, 1143, 2800, 46, 276, "Text",ExpressionUUID->"d273dc19-d4c8-4d4d-ac11-a90c679ffd2d"],
Cell[64848, 1191, 186, 4, 61, "Input",ExpressionUUID->"bed8a486-e72e-4601-9e61-0d364b853f00",
 InitializationCell->True],
Cell[65037, 1197, 10656, 158, 824, "Input",ExpressionUUID->"a7d6b389-5ad1-40da-97c2-3092f31aaaed",
 InitializationCell->True],
Cell[75696, 1357, 177, 4, 61, "Input",ExpressionUUID->"d1227785-abb2-48fc-828c-8a018c31f534",
 InitializationCell->True],
Cell[75876, 1363, 36513, 868, 2707, "Input",ExpressionUUID->"bb60f128-836c-43fc-9fe6-c951d367fb4f",
 InitializationCell->True],
Cell[112392, 2233, 1044, 27, 61, "Input",ExpressionUUID->"a8d5b26e-98d7-4463-aecc-41a4eaee789c",
 InitializationCell->True],
Cell[113439, 2262, 96778, 2292, 5289, "Input",ExpressionUUID->"4457be58-6539-4337-9cf7-2b1d25707bf7",
 InitializationCell->True],
Cell[210220, 4556, 200, 6, 61, "Input",ExpressionUUID->"06af5f88-107a-4c10-b0d3-7ac18c7c03e8",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[210445, 4566, 284, 7, 61, "Input",ExpressionUUID->"0e8d89d6-b252-4417-bb75-0c874721e536",
 InitializationCell->True],
Cell[210732, 4575, 246, 3, 32, "Output",ExpressionUUID->"671177a8-4398-4de5-9363-10e7a4f169bc"]
}, Open  ]]
}, Open  ]]
}
]
*)

